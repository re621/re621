{"version":3,"file":"script.user.js","mappings":"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","sources":["webpack://re621/./src/js/models/Script.ts","webpack://re621/./src/js/components/utility/UtilID.ts","webpack://re621/./src/js/components/utility/UtilNetwork.ts","webpack://re621/./src/js/components/utility/UtilSize.ts","webpack://re621/./src/js/components/utility/UtilTime.ts","webpack://re621/./src/js/components/utility/Util.ts","webpack://re621/./src/js/components/utility/UtilDOM.ts","webpack://re621/./src/js/components/utility/UtilEvents.ts","webpack://re621/./src/js/components/utility/UtilMath.ts","webpack://re621/./src/js/components/api/XMChrome.ts","webpack://re621/./src/js/components/api/XMConnect.ts","webpack://re621/./src/js/components/api/XMStorage.ts","webpack://re621/./src/js/components/api/XM.ts","webpack://re621/./src/js/components/api/XMUtil.ts","webpack://re621/./src/js/components/utility/Debug.ts","webpack://re621/./src/js/components/api/E621.ts","webpack://re621/./src/js/components/data/User.ts","webpack://re621/./src/js/components/data/Page.ts","webpack://re621/./src/js/components/structure/DOMTools.ts","webpack://re621/./src/js/components/structure/PageObserver.ts","webpack://re621/./src/js/components/structure/Modal.ts","webpack://re621/./src/js/components/utility/ErrorHandler.ts","webpack://re621/./src/js/components/data/Keybinds.ts","webpack://re621/./src/js/components/structure/Form.ts","webpack://re621/./src/js/modules/Component.ts","webpack://re621/./src/js/modules/general/HeaderCustomizer.ts","webpack://re621/./src/js/modules/general/ThemeCustomizer.ts","webpack://re621/./src/js/modules/minor/DMailHeaderButton.ts","webpack://re621/./src/RE621.ts"],"sourcesContent":["export default class Script {\n}\nScript.version = GM_info.script.version;\nScript.handler = {\n    name: GM_info.scriptHandler,\n    version: GM_info.version,\n};\nScript.url = {\n    website: \"https://re621.bitwolfy.com/\",\n    repo: \"https://github.com/re621/re621/\",\n    issues: \"https://github.com/re621/re621/issues\",\n    thread: \"https://e621.net/forum_topics/25872\",\n    latest: \"https://api.github.com/repos/re621/re621/releases/latest\",\n};\n","import { Util } from \"./Util\";\nexport class UtilID {\n    /**\n     * Creates a random string of letters, to be used as an ID.\n     * @param length String length. Defaults to 8\n     * @param unique If false, simply returns a randomized string\n     */\n    static make(length = 8, unique = true) {\n        if (!unique)\n            return getRandomString(length);\n        let uniqueID;\n        do {\n            uniqueID = getRandomString(length);\n        } while (UtilID.uniqueIDs.has(uniqueID));\n        UtilID.uniqueIDs.add(uniqueID);\n        return uniqueID;\n        function getRandomString(length) {\n            let result = '';\n            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', charLength = chars.length;\n            for (let i = 0; i < length; i++) {\n                result += chars.charAt(Math.floor(Math.random() * charLength));\n            }\n            return result;\n        }\n    }\n    /**\n     * Checks whether the specified ID has been registered\n     * @param id String ID to check\n     */\n    static has(id) {\n        return UtilID.uniqueIDs.has(id);\n    }\n    /**\n     * Remove the provided ID from the records.\n     * Make sure that the corresponding element has also been removed, to avoid possible collisions\n     * @param id String ID to remove\n     * @returns true if the ID existed, false otherwise\n     */\n    static remove(id) {\n        if (!UtilID.has(id))\n            return false;\n        UtilID.uniqueIDs.delete(id);\n        return true;\n    }\n    /** Returns a pseudo-random number. Don't use for anything serious, please. */\n    static rand() {\n        return (Util.Time.now() + \"\").slice(-5);\n    }\n}\nUtilID.uniqueIDs = new Set();\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { XM } from \"../api/XM\";\nexport class UtilNetwork {\n    static isOnline() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Not terribly reliable.\n            // If the computer is connected to any network, including LAN, this\n            // will return true. So, if there's a connection to the router, but\n            // not to the internet as a whole, this will not work.\n            if (!navigator.onLine)\n                return Promise.resolve(false);\n            // Fallback method\n            // Tries to make a HEAD request to e621.net, and checks if it works\n            return new Promise((resolve) => {\n                XM.Connect.xmlHttpRequest({\n                    method: \"HEAD\",\n                    url: window.location.host == \"e621.net\" ? \"https://e621.net/\" : \"https://e926.net/\",\n                    onerror: () => { resolve(false); },\n                    onload: () => { resolve(true); },\n                });\n            });\n        });\n    }\n}\n","import { Util } from \"./Util\";\nexport var UtilSize;\n(function (UtilSize) {\n    UtilSize[UtilSize[\"Byte\"] = 1] = \"Byte\";\n    UtilSize[UtilSize[\"Kilobyte\"] = 1024] = \"Kilobyte\";\n    UtilSize[UtilSize[\"Megabyte\"] = 1048576] = \"Megabyte\";\n    UtilSize[UtilSize[\"Gigabyte\"] = 1073741824] = \"Gigabyte\";\n    UtilSize[UtilSize[\"Terabyte\"] = 1099511627776] = \"Terabyte\";\n    UtilSize[UtilSize[\"Petabyte\"] = 1125899906842624] = \"Petabyte\";\n})(UtilSize || (UtilSize = {}));\n;\n(function (UtilSize) {\n    /**\n     * Converts a byte number into a formatted string\n     * @param bytes Number\n     * @param decimals Decimal places\n     */\n    function format(bytes, decimals = 2) {\n        if (typeof bytes == \"string\")\n            bytes = parseInt(bytes);\n        if (!bytes || bytes === 0)\n            return \"0 B\";\n        const k = 1024;\n        const dm = decimals < 0 ? 0 : decimals;\n        const sizes = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\"];\n        const i = Math.floor(Math.log(bytes) / Math.log(k));\n        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + sizes[i];\n    }\n    UtilSize.format = format;\n    /**\n     * Takes in a formatted file size string (ex. 5MB) and converts it to bytes\n     * @param input Formatted string\n     */\n    function unformat(input) {\n        if (Util.Math.isNumeric(input))\n            return parseInt(input);\n        input = input.toUpperCase();\n        for (const [index, size] of [/\\dB$/, /\\dKB$/, /\\dMB$/, /\\dGB$/, /\\dTB$/, /\\dPB$/].entries()) {\n            if (size.test(input)) {\n                return parseInt(input) * Math.pow(1024, index);\n            }\n        }\n        return 0;\n    }\n    UtilSize.unformat = unformat;\n})(UtilSize || (UtilSize = {}));\nexport class RISSizeLimit {\n    constructor(size, width = 0, height = 0) {\n        this.size = size;\n        this.width = width;\n        this.height = height;\n    }\n    test(post) {\n        return post.file.size <= this.size\n            && (this.width == 0 || post.img.width <= this.width)\n            && (this.height == 0 || post.img.height <= this.height);\n    }\n    toString() {\n        return `${this.width}x${this.height} (${this.size})`;\n    }\n}\nRISSizeLimit.Google = new RISSizeLimit(20 * UtilSize.Megabyte, 8000, 6000);\nRISSizeLimit.SauceNAO = new RISSizeLimit(15 * UtilSize.Megabyte);\nRISSizeLimit.Derpibooru = new RISSizeLimit(20 * UtilSize.Megabyte);\nRISSizeLimit.Kheina = new RISSizeLimit(8 * UtilSize.Megabyte, 7500, 7500);\nRISSizeLimit.Yandex = new RISSizeLimit(100 * UtilSize.Megabyte, 150000, 150000);\n","export var UtilTime;\n(function (UtilTime) {\n    UtilTime[UtilTime[\"SECOND\"] = 1000] = \"SECOND\";\n    UtilTime[UtilTime[\"MINUTE\"] = 60000] = \"MINUTE\";\n    UtilTime[UtilTime[\"HOUR\"] = 3600000] = \"HOUR\";\n    UtilTime[UtilTime[\"DAY\"] = 86400000] = \"DAY\";\n    UtilTime[UtilTime[\"WEEK\"] = 604800000] = \"WEEK\";\n    UtilTime[UtilTime[\"MONTH\"] = 2592000000] = \"MONTH\";\n    UtilTime[UtilTime[\"YEAR\"] = 31536000000] = \"YEAR\";\n})(UtilTime || (UtilTime = {}));\n;\n(function (UtilTime) {\n    /** Returns current timestamp. Alias for `new Date().getTime();` */\n    function now() {\n        return new Date().getTime();\n    }\n    UtilTime.now = now;\n    /**\n     * Converts time from absolute format to relative (i.e. \"5 minutes ago\")\n     * @param time Time to process\n     * @returns Relative time string\n     */\n    function ago(time) {\n        switch (typeof time) {\n            case 'string':\n                time = +new Date(time);\n                break;\n            case 'object':\n                time = time.getTime();\n                break;\n        }\n        const timeFormats = [\n            [60, 'seconds', 1],\n            [120, '1 minute ago', '1 minute from now'],\n            [3600, 'minutes', 60],\n            [7200, '1 hour ago', '1 hour from now'],\n            [86400, 'hours', 3600],\n            [172800, 'Yesterday', 'Tomorrow'],\n            [604800, 'days', 86400],\n            [1209600, 'Last week', 'Next week'],\n            [2419200, 'weeks', 604800],\n            [4838400, 'Last month', 'Next month'],\n            [29030400, 'months', 2419200],\n            [58060800, 'Last year', 'Next year'],\n            [2903040000, 'years', 29030400],\n            [5806080000, 'Last century', 'Next century'],\n            [58060800000, 'centuries', 2903040000] // 60*60*24*7*4*12*100*20, 60*60*24*7*4*12*100\n        ];\n        let seconds = (+new Date() - time) / 1000, token = 'ago', listChoice = 1;\n        if (seconds >= 0 && seconds < 2) {\n            return 'Just now';\n        }\n        if (seconds < 0) {\n            seconds = Math.abs(seconds);\n            token = 'from now';\n            listChoice = 2;\n        }\n        let i = 0, format;\n        while (format = timeFormats[i++])\n            if (seconds < format[0]) {\n                if (typeof format[2] == 'string')\n                    return format[listChoice];\n                else\n                    return Math.floor(seconds / format[2]) + ' ' + format[1] + ' ' + token;\n            }\n        return time + \"\";\n    }\n    UtilTime.ago = ago;\n    /**\n     * Formats the provided date as a string in YYYY-MM-DD HH:SS format\n     * @param date Date to format. If none is provided, formats current date\n     */\n    function format(date = new Date()) {\n        if (typeof date == \"number\" || typeof date == \"string\")\n            date = new Date(date);\n        const parts = {\n            year: \"\" + date.getFullYear(),\n            month: \"\" + (date.getMonth() + 1),\n            day: \"\" + date.getDate(),\n            hours: \"\" + date.getHours(),\n            minutes: \"\" + date.getMinutes(),\n            seconds: \"\" + date.getSeconds(),\n        };\n        for (const id in parts) {\n            if (parts[id].length < 2)\n                parts[id] = \"0\" + parts[id];\n        }\n        return parts.year + \"-\" + parts.month + \"-\" + parts.day + \" \" + parts.hours + \":\" + parts.minutes + \":\" + parts.seconds;\n    }\n    UtilTime.format = format;\n    function formatPeriod(input) {\n        if (input < UtilTime.MINUTE)\n            return (input / UtilTime.SECOND).toFixed(1) + \" seconds\";\n        if (input < UtilTime.HOUR)\n            return (input / UtilTime.MINUTE).toFixed(1) + \" minutes\";\n        if (input < UtilTime.DAY)\n            return (input / UtilTime.HOUR).toFixed(1) + \" hours\";\n        if (input < UtilTime.WEEK)\n            return (input / UtilTime.DAY).toFixed(1) + \" days\";\n        if (input < UtilTime.MONTH)\n            return (input / UtilTime.WEEK).toFixed(1) + \" weeks\";\n        if (input < UtilTime.YEAR)\n            return (input / UtilTime.MONTH).toFixed(1) + \" months\";\n        return (input / UtilTime.YEAR).toFixed(1) + \" years\";\n    }\n    UtilTime.formatPeriod = formatPeriod;\n    /**\n     * Returns the current date and time in a compressed format.\n     * Used to make downloaded file names unique, i.e. download-200405-0350.zip instead of download.zip\n     * @returns String with a date and time in YYMMDD-HHMM format.\n     */\n    function getDatetimeShort() {\n        function twoDigit(n) { return (n < 10 ? '0' : '') + n; }\n        const date = new Date();\n        return (date.getFullYear() + \"\").substring(2) + twoDigit(date.getMonth() + 1) + twoDigit(date.getDate()) + \"-\" + twoDigit(date.getHours()) + twoDigit(date.getMinutes());\n    }\n    UtilTime.getDatetimeShort = getDatetimeShort;\n    function formatPlaytime(seconds) {\n        seconds = Math.ceil(seconds);\n        const remainder = (seconds % 60);\n        return Math.floor(seconds / 60) + \":\" + (remainder < 10 ? \"0\" : \"\") + remainder;\n    }\n    UtilTime.formatPlaytime = formatPlaytime;\n})(UtilTime || (UtilTime = {}));\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { UtilDOM } from \"./UtilDOM\";\nimport { UtilEvents } from \"./UtilEvents\";\nimport { UtilID } from \"./UtilID\";\nimport { UtilMath } from \"./UtilMath\";\nimport { UtilNetwork } from \"./UtilNetwork\";\nimport { UtilSize } from \"./UtilSize\";\nimport { UtilTime } from \"./UtilTime\";\n/**\n * Common utilities used in other modules\n */\nexport class Util {\n    /**\n     * Downloads the provided object as a JSON file\n     * @param data Object to download\n     * @param file File name\n     */\n    static downloadAsJSON(data, file) {\n        const tempLink = $(\"<a>\")\n            .attr({\n            \"download\": file + \".json\",\n            \"href\": \"data:application/json,\" + encodeURIComponent(JSON.stringify(data, null, 4)),\n        })\n            .appendTo(\"body\")\n            .on(\"click\", () => { tempLink.remove(); });\n        tempLink[0].click();\n    }\n    /**\n     * Returns a promise that is fulfilled after the specified time period elapses\n     * @param time Time period, in milliseconds\n     */\n    static sleep(time) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve) => { setTimeout(() => { resolve(); }, time); });\n        });\n    }\n    /**\n     * Split the array into chunks of specified size.\n     * The `method` parameter defines how the array is split.\n     * - \"balance\": the chunks are at most `size` big, but otherwise of equal size\n     * - \"chunk\": all chunks except for the last one of equal size\n     * - \"split\": first chunk is `size` big, the second contains the remainder\n     * @param input Original array\n     * @param size Size of the resulting chunks\n     * @param method Method by which the array is split\n     * @returns Array of smaller arrays of specified size\n     */\n    static chunkArray(input, size, method = \"balance\") {\n        if (!Array.isArray(input))\n            input = Array.from(input);\n        const result = [];\n        switch (method) {\n            case \"chunk\": {\n                for (let i = 0; i < input.length; i += size)\n                    result.push(input.slice(i, i + size));\n                break;\n            }\n            case \"split\": {\n                result[0] = input.slice(0, size);\n                result[1] = input.slice(size);\n                break;\n            }\n            case \"balance\":\n            default: {\n                const parts = Math.ceil(input.length / size);\n                for (let i = parts; i > 0; i--)\n                    result.push(input.splice(0, Math.ceil(input.length / i)));\n            }\n        }\n        return result;\n    }\n    /**\n     * Returns the indexes of all instances of the specified value in an array\n     * @param input Array to search\n     * @param value Value to look for\n     * @returns Array of number indexes\n     */\n    static getArrayIndexes(input, value) {\n        const indexes = [];\n        let i = 0;\n        for (; i < input.length; i++) {\n            if (input[i] === value)\n                indexes.push(i);\n        }\n        return indexes;\n    }\n    /**\n     * Convert markdown input into html.\n     * Very limited in scope, don't rely on this for anything important.\n     * @param input Markdown input\n     * @returns HTML output\n     */\n    static quickParseMarkdown(input) {\n        if (input === undefined)\n            return \"\";\n        return input\n            .replace(/\\*\\*(.*?)\\*\\*/gm, \"<strong>$1</strong>\")\n            .replace(/\\_(.*?\\S)\\_/gm, \"<em>$1</em>\")\n            .replace(/\\[(.+)\\]\\((.*)\\)/gm, `<a href=\"$2\">$1</a>`)\n            .replace(/^[-]+(.*)?/gmi, \"<ul><li>$1</li></ul>\")\n            .replace(/\\<\\/ul\\>\\r\\n\\<ul\\>/gm, \"\")\n            .replace(/\\n(?!<)/gm, \"<br />\");\n    }\n    /**\n     * Parses the provided DText string, returning it as plain text\n     * @param input Input to process\n     * @param removeSections If true, removes `quote`, `code`, and `sections` blocks altogether\n     */\n    static stripDText(input, removeSections = true) {\n        if (removeSections) {\n            input = input.replace(/\\[quote\\][\\s\\S]*\\[\\/quote\\]/g, \"\")\n                .replace(/\\[code\\][\\s\\S]*\\[\\/code\\]/g, \"\")\n                .replace(/\\\\[section[\\s\\S]*\\[\\/section\\]/g, \"\");\n        }\n        input = input\n            .replace(/\\[b\\]([\\s\\S]*)\\[\\/b\\]/g, \"<b>$1</b>\") // bold\n            .replace(/\\[i\\]([\\s\\S]*)\\[\\/i\\]/g, \"<i>$1</i>\") // italics\n            .replace(/\\[u\\]([\\s\\S]*)\\[\\/u\\]/g, \"<u>$1</u>\") // Underline\n            .replace(/\\[o\\]([\\s\\S]*)\\[\\/o\\]/g, \"<o>$1</o>\") // Overline\n            .replace(/\\[s\\]([\\s\\S]*)\\[\\/s\\]/g, \"<s>$1</s>\") // Strikeout\n            .replace(/\\[sup\\]([\\s\\S]*)\\[\\/sup\\]/g, \"<sup>$1</sup>\") // Superscript\n            .replace(/\\[sub\\]([\\s\\S]*)\\[\\/sub\\]/g, \"<sub>$1</sub>\") // Subscript\n            .replace(/\\[spoiler\\]([\\s\\S]*)\\[\\/spoiler\\]/g, \"<span>$1</span>\") // Spoiler\n            .replace(/\\[color\\]([\\s\\S]*)\\[\\/color\\]/g, \"<span>$1</span>\"); // Color\n        return input;\n    }\n    /**\n     * Trims the thousands off a number and replaced them with a K.\n     * ex. 54321 -> 54.3k\n     * @param num Number to trim\n     */\n    static formatK(num) {\n        return Math.abs(num) > 999 ? (Math.sign(num) * (Math.abs(num) / 1000)).toFixed(1) + \"k\" : Math.sign(num) * Math.abs(num) + \"\";\n    }\n    /* returns an array with the ratio */\n    static formatRatio(width, height) {\n        const d = gcd(width, height);\n        return [width / d, height / d];\n        function gcd(u, v) {\n            if (u === v)\n                return u;\n            if (u === 0)\n                return v;\n            if (v === 0)\n                return u;\n            if (~u & 1)\n                if (v & 1)\n                    return gcd(u >> 1, v);\n                else\n                    return gcd(u >> 1, v >> 1) << 1;\n            if (~v & 1)\n                return gcd(u, v >> 1);\n            if (u > v)\n                return gcd((u - v) >> 1, v);\n            return gcd((v - u) >> 1, u);\n        }\n    }\n    /**\n     * Parses the textarea input specified in the parameter and returns a list of space-separated tags\n     * @param input Textarea to parse\n     */\n    static getTagString(input) {\n        return input.val().toString().trim()\n            .toLowerCase()\n            .replace(/\\r?\\n|\\r/g, \" \") // strip newlines\n            .replace(/(?:\\s){2,}/g, \" \"); // strip multiple spaces\n    }\n    static getTags(input) {\n        if (Array.isArray(input)) {\n            const result = [];\n            for (const element of input)\n                result.push(...Util.getTags(element));\n            return result;\n        }\n        return (typeof input === \"string\" ? input : Util.getTagString(input))\n            .split(\" \")\n            .filter((el) => { return el != null && el != \"\"; });\n    }\n    /** Takes in an object, and returns a regular expression with its keys */\n    static getKeyRegex(object) {\n        const result = [];\n        for (const key of Object.keys(object))\n            result.push(key.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n        return new RegExp(result.join(\"|\"), \"gi\");\n    }\n    /**\n     * Compares two software version numbers (e.g. \"1.7.1\" or \"1.2b\").\n     *\n     * This function was born in http://stackoverflow.com/a/6832721.\n     *\n     * @param v1 The first version to be compared.\n     * @param v2 The second version to be compared.\n     * @param [options] Optional flags that affect comparison behavior:\n     *      `lexicographical` _boolean_ compares each part of the version strings lexicographically instead of\n     *      naturally; this allows suffixes such as \"b\" or \"dev\" but will cause \"1.10\" to be considered smaller than \"1.2\".\n     *      `zeroExtend` _boolean_ changes the result if one version string has less parts than the other. In\n     *         this case the shorter string will be padded with \"zero\" parts instead of being considered smaller.\n     * @returns {number|NaN}\n     *      - 0 if the versions are equal\n     *      - a negative integer iff v1 < v2\n     *      - a positive integer iff v1 > v2\n     *      - NaN if either version string is in the wrong format\n     * @copyright by Jon Papaioannou (`john.papaioannou@gmail.com`)\n     * @license This function is in the public domain. Do what you want with it, no strings attached.\n     */\n    static versionCompare(v1, v2, options) {\n        const lexicographical = options && options.lexicographical, zeroExtend = options && options.zeroExtend;\n        if (typeof v1 !== \"string\" || typeof v2 !== \"string\")\n            return NaN;\n        let v1parts = v1.split('.'), v2parts = v2.split('.');\n        function isValidPart(x) {\n            return (lexicographical ? /^\\d+[A-Za-z]*$/ : /^\\d+$/).test(x);\n        }\n        if (!v1parts.every(isValidPart) || !v2parts.every(isValidPart))\n            return NaN;\n        if (zeroExtend) {\n            while (v1parts.length < v2parts.length)\n                v1parts.push(\"0\");\n            while (v2parts.length < v1parts.length)\n                v2parts.push(\"0\");\n        }\n        if (!lexicographical) {\n            v1parts = v1parts.map(Number);\n            v2parts = v2parts.map(Number);\n        }\n        for (let i = 0; i < v1parts.length; ++i) {\n            if (v2parts.length == i)\n                return 1;\n            if (v1parts[i] == v2parts[i])\n                continue;\n            else if (v1parts[i] > v2parts[i])\n                return 1;\n            else\n                return -1;\n        }\n        if (v1parts.length != v2parts.length)\n            return -1;\n        return 0;\n    }\n    /**\n     * Formats an array into a string via a non-standard join method.\n     * Ex. [\"one\"] => \"one\"\n     *     [\"one\", \"two\"] => \"one and two\"\n     *     [\"one\", \"two\", \"three\"] => \"one, two, and three\"\n     * @param array Array to format\n     * @param delimiter Delimiter for the last element\n     */\n    static prettyPrintArray(array, delimiter = \"and\") {\n        if (array.length == 1)\n            return array[0];\n        else if (array.length == 2)\n            return array[0] + \" \" + delimiter + \" \" + array[1];\n        return array.slice(0, -1).join(\", \") + \", \" + delimiter + \" \" + array.slice(-1);\n    }\n}\nUtil.DOM = UtilDOM;\nUtil.Events = UtilEvents;\nUtil.ID = UtilID;\nUtil.Math = UtilMath;\nUtil.Network = UtilNetwork;\nUtil.Time = UtilTime;\nUtil.Size = UtilSize;\nUtil.LS = window.localStorage;\nUtil.SS = window.sessionStorage;\n","import { Util } from \"./Util\";\nexport class UtilDOM {\n    /**\n     * Adds a button to the top-right of the navbar\n     * @param config Button configuration\n     * @param target Target element\n     */\n    static addSettingsButton(config, target = \"menu.extra\") {\n        if (config.name === undefined)\n            config.name = \"T\";\n        if (config.href === undefined)\n            config.href = \"\";\n        if (config.title === undefined)\n            config.title = \"\";\n        if (config.tabClass === undefined)\n            config.tabClass = \"\";\n        if (config.linkClass === undefined)\n            config.linkClass = \"\";\n        if (config.attr === undefined)\n            config.attr = {};\n        const $tab = $(`<li>`).appendTo(target);\n        const $link = $(\"<a>\")\n            .html(config.name)\n            .attr({\n            \"title\": config.title,\n            \"id\": config.id,\n        })\n            .appendTo($tab);\n        if (config.onClick !== undefined)\n            $link.on(\"click\", () => { config.onClick($link); });\n        if (config.href) {\n            $link.attr(\"href\", config.href);\n        }\n        if (config.tabClass) {\n            $tab.addClass(config.tabClass);\n        }\n        if (config.linkClass) {\n            $link.addClass(config.linkClass);\n        }\n        if (config.attr) {\n            $link.attr(config.attr);\n        }\n        return $link;\n    }\n    /**\n     * Adds the given style to the document and returns the injected style element\n     * @param css string CSS styles\n     */\n    static addStyle(css) {\n        return $(\"<style>\")\n            .attr({\n            \"id\": Util.ID.make(),\n            \"type\": \"text/css\"\n        })\n            .html(css)\n            .appendTo(\"head\");\n    }\n    /**\n     * Returns a base-64 encoded image used for placeholder during lazy loading\n     */\n    static getPlaceholderImage() {\n        return \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n    }\n    static getKoFiImage() {\n        return \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALsAAAAkBAMAAAAjjlbPAAAAHlBMVEVDS1dDS1dDS1f+/v5DS1fi4uOLjpO8vcD/X1z/p6boDZakAAAAA3RSTlMCtVgF8JOLAAACCElEQVRIx+3XMW7bMBQGYLUnCIoeoENv8OuZ8NbAP8kDUBTRWbRyANLxAbKwc1AguW0H2nJSq6kBV0sRDhpI4BP19PhINs3Hz1yofWqapllMJ2+a5sNyOm+b5uuCPL8sGRvypllS57d3/gLe+KmF+O95jVOTuCiP1eGLxvFySftoffw7Lw5S+xKgLuadj8nnN/j1T3x/BFo61FmksMPFvJDuzeCU8lyKQ8sN6ixSJrin7XRmIBmSsuio0ZE0TnmSFooaPXcIW3hukWnRz/BSSinlES31ke9HoaNuNx2FJATOKcILyUGckHSC6DxyggzACKeYPOI5vz7ngdUrnkNrxK6YMumyFdIIjVUc2hqcTUs3Cod2NjgHfjjyYYf4ghcOHUWLdx0ppJBWkbqlXVV+EI+9eDfHP5VSfgCtcYcfmjJTfsVvKu/zxK9+5/2deN/NZU4p5QGQKR3P+aGj6LoqHE0NDrWiXk3BoVV/yPunUmrqH16ewh4x9anbqO1p9gb3LpIpJCGJPo24d13lrew9XZ/yHL8uDwCAwBfLSgPRQE48E4SkrX1bSBwgx7xPUNxiLnMAPAOAmipBLQpjJMdRSEYaMtae47MORzKShjTjaWS+KLTnK9KGpK4raXbiuxkeyFfW+4mfq8YmXrtb3XnvfQj7/L7X/i/8wofAhY+wCx/AF74+LHv5+QUPP47PCU3CGwAAAABJRU5ErkJggg==\";\n    }\n    static getLoadingImage() {\n        return \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAyVBMVEUAAAC9vsDCw8W9v8G9vsD29/fr7O29vsDm5+jx8fK/wML29vf///+9vsHR0tPm5+jt7u7w8PHr7Ozc3d7n6OnExcfGx8nJyszMzM7V1tjZ2tvf4OG9vsDHyMrp6uvIycu9v8HAwcTPz9HCw8W9vsC9vsDBwsTj5OXj5OXW19i9vsDm5+jw8PHy8vL09fW9vsDFxsjJyszAwsS9vsDU1dbLzM7Y2drb3N3c3d7e3+DHyMrBwsTh4uPR0tPDxcfa293R0tTV1ti9vsAll6RJAAAAQnRSTlMA7+t/MAZHQDYjHxABv6xSQjEgFgzi2M7Emop0cGVLD/ryt7Cfj3dmYWBgWjgsGd/Cv7SvopSSg4B6eHZrQjkyKx1dd0xhAAAA9klEQVR4AYWPeXOCMBBHFxIgCQKC3KCo1Wprtfd98/0/VBPb6TC0Wd+/783+ZqELrQkRoIMujFbiaLTwpESC029reB7919d7u6SgYaE8aUCivW84oEUY0lPQc408pxBqHxCIHGiw4Lxtl5h35ALFglouAAaZTj00OJ7NrvDANI/Q4PlQMDbNFA3ekiQRaHGRpmM0eMqyyxgLRlme4ydu8/n8Az3h+37xiRWv/k1RRlhxUtyVD8yCXwaDflHeP1Zr5sIey3WtfvFeVS+rTWAzFobhNhrFf4omWK03wcS2h8OzLd/1TyhiNvkJQu5amocjznm0i6HDF1RMG1aMA/PYAAAAAElFTkSuQmCC\";\n    }\n}\n","export class UtilEvents {\n    /**\n     * Attaches a handler function to a document event with the specified name\n     * @param name Event selector\n     * @param callback Handler function\n     */\n    static on(name, callback) {\n        $(document).on(name, (event, data) => {\n            callback(event, data);\n        });\n    }\n    /**\n     * Executes a handler function exactly once whe encountering a specified event\n     * @param name Event selector\n     * @param callback Handler function\n     */\n    static one(name, callback) {\n        $(document).on(name, (event, data) => {\n            callback(event, data);\n            this.off(name);\n        });\n    }\n    /**\n     * Detaches all handlers from the specified module event\n     * @param name Event selector\n     */\n    static off(name) {\n        $(document).off(name);\n    }\n    /**\n     * Execute all handlers for the specified module event\n     * @param name Event selector\n     * @param data Event data\n     */\n    static trigger(name, data) {\n        $(document).trigger(name, data);\n    }\n    /**\n     * Workaround for vue not receiving normal events.\n     * @param element Element to trigger the event on\n     * @param name Name of the event to trigger\n     * @param label Data attribute to set on the element\n     */\n    static triggerVueEvent(element, name, label) {\n        const e = document.createEvent('HTMLEvents');\n        e.initEvent(name, true, true);\n        if (label)\n            element.data(label, \"true\");\n        element[0].dispatchEvent(e);\n    }\n}\n","export class UtilMath {\n    static clamp(value, min, max) {\n        return Math.min(Math.max(value, min), max);\n    }\n    static between(value, min, max) {\n        return min <= value && max >= value;\n    }\n    static isNumeric(value) {\n        return !isNaN(Number(value));\n    }\n    static round(num, decimal = 2) {\n        if (decimal == 0)\n            return parseInt(num.toFixed(decimal));\n        else\n            return parseFloat(num.toFixed(decimal));\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Util } from \"../utility/Util\";\nexport class XMChrome {\n    /**\n     * Executes the specified function in the background script\n     * @param component Component to run the script on, ex. Danbooru\n     * @param module Component module, ex. Blacklist\n     * @param method Function to execute, ex. apply\n     * @param args Optional arguments to pass to the function\n     * @returns Promise that is fulfilled when a response is received\n     */\n    static execBackgroundRequest(component, module, method, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve) => {\n                chrome.runtime.sendMessage(XMChrome.formatRequestData(component, module, method, args), (response) => {\n                    XMChrome.requests = XMChrome.requests.filter(e => e !== response.eventID);\n                    resolve(response.data);\n                });\n            });\n        });\n    }\n    /**\n     * Establishes a connection to the background script\n     * @returns Promise containing the port object\n     */\n    static execBackgroundConnection(component) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return Promise.resolve(chrome.runtime.connect({ name: component }));\n        });\n    }\n    /**\n     * Executes the specified function in the injector script\n     * @param component Component to run the script on, ex. Danbooru\n     * @param module Component module, ex. Blacklist\n     * @param method Function to execute, ex. apply\n     * @param args Optional arguments to pass to the function\n     * @returns Promise that is fulfilled when a response is received\n     */\n    static execInjectorRequest(component, module, method, args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve) => {\n                const request = XMChrome.formatRequestData(component, module, method, args);\n                const callback = function (event) {\n                    const response = event.detail;\n                    document.removeEventListener(\"re621.chrome.message.response-\" + response.eventID, callback);\n                    XMChrome.requests = XMChrome.requests.filter(e => e !== response.eventID);\n                    resolve(response.data);\n                };\n                document.addEventListener(\"re621.chrome.message.response-\" + request.eventID, callback);\n                document.dispatchEvent(new CustomEvent(\"re621.chrome.message\", { detail: request }));\n            });\n        });\n    }\n    /**\n     * Formats the provided arguments into a valid request\n     * @param component Component to run the script on, ex. Danbooru\n     * @param module Component module, ex. Blacklist\n     * @param method Function to execute, ex. apply\n     * @param args Optional arguments to pass to the function\n     */\n    static formatRequestData(component, module, method, args) {\n        return {\n            component: component,\n            module: module,\n            method: method,\n            eventID: makeRequestID(),\n            args: (args === undefined) ? [] : args,\n        };\n        function makeRequestID() {\n            let id;\n            do {\n                id = Util.ID.make(8, false);\n            } while (XMChrome.requests.includes(id));\n            XMChrome.requests.push(id);\n            return id;\n        }\n    }\n    /**\n     * Returns the URL for the specified resource.\n     * Note that the resource must be specified in the manifest.\n     * @param name Resource name\n     */\n    static getResourceURL(name) {\n        return chrome.extension.getURL(name);\n    }\n    static download(url, name, saveAs) {\n        return chrome.downloads.download({\n            url: url,\n            filename: name,\n            saveAs: saveAs,\n        });\n    }\n}\nXMChrome.requests = [];\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Debug } from \"../utility/Debug\";\nimport { XM } from \"./XM\";\nexport class XMConnect {\n    /**\n     * Make a cross-domain xmlHttpRequest.\n     * For userscripts, the domain name MUST be defined in @resource tag.\n     * For extensions, the domain name MUST be listed in the permissions.\n     * @param details Request details\n     */\n    static xmlHttpRequest(details) {\n        Debug.connectLog(details.url);\n        const validDetails = XMConnect.validateXHRDetails(details);\n        if (typeof GM !== \"undefined\" && typeof GM.xmlHttpRequest === \"function\")\n            GM.xmlHttpRequest(validDetails);\n        else if (typeof GM_xmlhttpRequest === \"function\")\n            GM_xmlhttpRequest(validDetails);\n        else\n            XM.Chrome.execBackgroundConnection(\"XHR\")\n                .then((port) => {\n                port.postMessage(validDetails);\n                port.onMessage.addListener((response) => __awaiter(this, void 0, void 0, function* () {\n                    if (response.event === \"onload\") {\n                        if (details.responseType === \"blob\")\n                            response.response = yield fetch(response.response).then(r => r.blob());\n                        else if (details.responseType === \"arraybuffer\")\n                            response.response = yield fetch(response.response).then(r => r.arrayBuffer());\n                        URL.revokeObjectURL(response[\"responseURL\"]);\n                    }\n                    details[response.event](response);\n                }));\n            });\n    }\n    ;\n    /**\n     * Cross-domain xmlHttpRequest, wrapped in a Promise.\n     * For userscripts, the domain name MUST be defined in @resource tag.\n     * For extensions, the domain name MUST be listed in the permissions.\n     * @param details Request details\n     */\n    static xmlHttpPromise(details) {\n        const validDetails = XMConnect.validateXHRDetails(details);\n        return new Promise((resolve, reject) => {\n            const callbacks = {\n                onabort: validDetails.onabort,\n                onerror: validDetails.onerror,\n                onload: validDetails.onload,\n                onloadstart: validDetails.onloadstart,\n                onprogress: validDetails.onprogress,\n                onreadystatechange: validDetails.onreadystatechange,\n                ontimeout: validDetails.ontimeout,\n            };\n            details.onabort = (event) => { callbacks.onabort(event); reject(event); };\n            details.onerror = (event) => { callbacks.onerror(event); reject(event); };\n            details.onload = (event) => { callbacks.onload(event); resolve(event); };\n            details.onloadstart = (event) => { callbacks.onloadstart(event); };\n            details.onprogress = (event) => { callbacks.onprogress(event); };\n            details.onreadystatechange = (event) => { callbacks.onreadystatechange(event); };\n            details.ontimeout = (event) => { callbacks.ontimeout(event); reject(event); };\n            XMConnect.xmlHttpRequest(validDetails);\n        });\n    }\n    /**\n     * Validates the xmlHttpRequest details, returning a valid set\n     * @param details Request details\n     */\n    static validateXHRDetails(details) {\n        if (details.headers === undefined)\n            details.headers = {};\n        if (details.headers[\"User-Agent\"] === undefined) {\n            details.headers[\"User-Agent\"] = window[\"re621\"][\"useragent\"];\n            details.headers[\"X-User-Agent\"] = window[\"re621\"][\"useragent\"];\n        }\n        if (details.onabort === undefined)\n            details.onabort = () => { return; };\n        if (details.onerror === undefined)\n            details.onerror = () => { return; };\n        if (details.onload === undefined)\n            details.onload = () => { return; };\n        if (details.onloadstart === undefined)\n            details.onloadstart = () => { return; };\n        if (details.onprogress === undefined)\n            details.onprogress = () => { return; };\n        if (details.onreadystatechange === undefined)\n            details.onreadystatechange = () => { return; };\n        if (details.ontimeout === undefined)\n            details.ontimeout = () => { return; };\n        return details;\n    }\n    ;\n    /**\n     * Get contents of the resource as plain text.\n     * Note that the name must be defined in a @resource tag in the script header.\n     * @param name Resource name\n     */\n    static getResourceText(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Tampermonkey\n            if (typeof GM_getResourceText === \"function\")\n                return Promise.resolve(GM_getResourceText(name));\n            // Greasemonkey / Violentmonkey\n            if (typeof GM !== \"undefined\")\n                return XMConnect.getResourceTextGM(name);\n            // Extensions\n            return XMConnect.xmlHttpPromise({\n                url: window[\"resources\"][name].startsWith(\"http\") ? window[\"resources\"][name] : XM.Chrome.getResourceURL(window[\"resources\"][name]),\n                method: \"GET\",\n            }).then((data) => { return Promise.resolve(data.responseText); }, (error) => { return Promise.reject(error.status + \" \" + error.statusText); });\n        });\n    }\n    /**\n     * Gets the contents of the resource as plain text.\n     * This function presumes Greasemonkey is used.\n     * Note that the name must be defined in a @resource tag in the script header.\n     * @param name Resource name\n     */\n    static getResourceTextGM(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const resource = (typeof GM.getResourceUrl === \"function\") ? yield GM.getResourceUrl(name) : GM_getResourceURL(name);\n            if (resource.startsWith(\"data:\")) {\n                return Promise.resolve(atob(resource.replace(/^data:(.*);base64,/g, \"\")));\n            }\n            else if (resource.startsWith(\"blob:\")) {\n                return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\n                    const request = yield fetch(resource, {\n                        credentials: \"include\",\n                        headers: {\n                            \"Content-Type\": \"application/x-www-form-urlencoded\",\n                            \"User-Agent\": window[\"re621\"][\"useragent\"],\n                            \"X-User-Agent\": window[\"re621\"][\"useragent\"],\n                        },\n                        method: \"GET\",\n                        mode: \"cors\"\n                    });\n                    if (request.ok) {\n                        resolve(yield request.text());\n                    }\n                    else {\n                        reject();\n                    }\n                }));\n            }\n            else {\n                return Promise.reject();\n            }\n        });\n    }\n    /**\n     * Get contents of the resource as JSON\n     * Note that the name must be defined in a @resource tag in the script header.\n     * @param name Resource name\n     */\n    static getResourceJSON(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return XMConnect.getResourceText(name).then((resolved) => { return Promise.resolve(JSON.parse(resolved)); }, (rejected) => { return Promise.reject(rejected); });\n        });\n    }\n    static download(a, b) {\n        if (typeof a === \"string\") {\n            a = {\n                url: a,\n                name: b,\n            };\n        }\n        if (a.headers === undefined)\n            a.headers = {\n                \"User-Agent\": window[\"re621\"][\"useragent\"],\n                \"X-User-Agent\": window[\"re621\"][\"useragent\"],\n            };\n        if (a.onerror === undefined)\n            a.onerror = () => { return; };\n        if (a.onload === undefined)\n            a.onload = () => { return; };\n        if (a.onprogress === undefined)\n            a.onprogress = () => { return; };\n        if (a.ontimeout === undefined)\n            a.ontimeout = () => { return; };\n        let timer;\n        XMConnect.xmlHttpRequest({\n            url: a.url,\n            method: \"GET\",\n            headers: a.headers,\n            responseType: \"blob\",\n            onerror: (event) => { a.onerror(event); },\n            ontimeout: (event) => { a.ontimeout(event); },\n            onprogress: (event) => {\n                if (timer)\n                    clearTimeout(timer);\n                timer = window.setTimeout(() => { a.onprogress(event); }, 500);\n            },\n            onload: (event) => {\n                a.onload(event);\n                const btn = $(\"<a>\")\n                    .attr({\n                    href: URL.createObjectURL(event.response),\n                    download: a.name,\n                })\n                    .html(\"download\")\n                    .on(\"click\", () => { btn.remove(); });\n                btn[0].click();\n            }\n        });\n    }\n    ;\n    static browserDownload(a, b, c) {\n        // Fallback to avoid a crash in Vivaldi\n        if (Debug.getState(\"vivaldi\"))\n            XM.Connect.download(a, b);\n        const downloadDetails = typeof a === \"string\"\n            ? { url: a, name: b, saveAs: c }\n            : a;\n        // Workaround to SWF files not being whitelisted by default in Tampermonkey\n        downloadDetails.onerror = (event) => {\n            if (event.error == \"not_whitelisted\")\n                XM.Connect.download(a, b);\n            else if (a.onerror)\n                a.onerror(event);\n            else\n                throw \"Error: unable to download file\" + (event.error ? (` [${event.error}]`) : \"\");\n        };\n        // All script managers should have a GM_download function, but the extension won't \n        if (typeof GM_download === \"function\")\n            GM_download(a);\n        else\n            XM.Chrome.download(a, b, c);\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport class XMStorage {\n    static setValue(name, value) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return GM_setValue(name, value);\n        });\n    }\n    static getValue(name, defaultValue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return GM_getValue(name, defaultValue);\n        });\n    }\n    static deleteValue(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return GM_deleteValue(name);\n        });\n    }\n    static addListener(name, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return GM_addValueChangeListener(name, callback);\n        });\n    }\n    static removeListener(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return GM_removeValueChangeListener(id);\n        });\n    }\n}\n","import Script from \"../../models/Script\";\nimport { XMChrome } from \"./XMChrome\";\nimport { XMConnect } from \"./XMConnect\";\nimport { XMStorage } from \"./XMStorage\";\nimport { XMUtil } from \"./XMUtil\";\nexport class XM {\n    /**\n     * Returns the information provided by the script manager\n     */\n    static info() {\n        if (typeof GM === \"undefined\") {\n            return {\n                script: null,\n                scriptMetaStr: null,\n                scriptHandler: Script.handler.name,\n                version: \"1.0\",\n            };\n        }\n        else\n            return GM.info;\n    }\n    /** Returns true if the current script instance is a userscript, false for extension */\n    static isUserscript() {\n        return window[\"re621\"].type == \"script\";\n    }\n}\nXM.Storage = XMStorage;\nXM.Connect = XMConnect;\nXM.Util = XMUtil;\nXM.Chrome = XMChrome;\nXM.Window = typeof unsafeWindow === \"undefined\" ? window : unsafeWindow;\n","import { XM } from \"./XM\";\nexport class XMUtil {\n    /**\n     * Open a new tab with this url.\n     * @param url Page URL\n     * @param options Tab options\n     */\n    static openInTab(path, active = true) {\n        if (typeof GM === \"undefined\")\n            XM.Chrome.execBackgroundRequest(\"XM\", \"Util\", \"openInTab\", [path, active]);\n        else\n            GM.openInTab(path, { active: active, });\n    }\n    /**\n     * Copies data into the clipboard\n     * @param data Data to be copied\n     * @param info object like \"{ type: 'text', mimetype: 'text/plain'}\" or a string expressing the type (\"text\" or \"html\")\n     */\n    static setClipboard(data, info) {\n        if (typeof GM === \"undefined\")\n            XM.Chrome.execBackgroundRequest(\"XM\", \"Util\", \"setClipboard\", [data]);\n        else\n            GM.setClipboard(data, info);\n    }\n    ;\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { XM } from \"../api/XM\";\nexport class Debug {\n    /** Initialize the debug logger */\n    static init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            Debug.enabled = yield XM.Storage.getValue(\"re621.debug.enabled\", false);\n            Debug.connect = yield XM.Storage.getValue(\"re621.debug.connect\", false);\n            Debug.perform = yield XM.Storage.getValue(\"re621.debug.perform\", false);\n            Debug.vivaldi = yield XM.Storage.getValue(\"re621.debug.vivaldi\", false);\n            return Promise.resolve(true);\n        });\n    }\n    static getState(type) {\n        return Debug[type];\n    }\n    static setState(type, enabled) {\n        Debug[type] = enabled;\n        if (enabled)\n            XM.Storage.setValue(\"re621.debug.\" + type, enabled);\n        else\n            XM.Storage.deleteValue(\"re621.debug.\" + type);\n    }\n    /** Logs the provided data into the console log if debug is enabled */\n    static log(...data) {\n        if (Debug.enabled)\n            console.log(...data);\n    }\n    /** Logs the provided data as a table */\n    static table(obj) {\n        if (!Debug.enabled)\n            return;\n        console.table(obj);\n    }\n    /** Logs the provided data into the console log if connections logging is enabled */\n    static connectLog(...data) {\n        if (Debug.connect)\n            console.log(\"CONNECT\", ...data);\n    }\n    /** Logs the provided data into the console log if performance logging is enabled */\n    static perfStart(input) {\n        if (Debug.perform)\n            console.time(input);\n    }\n    /** Logs the provided data into the console log if performance logging is enabled */\n    static perfEnd(input) {\n        if (Debug.perform)\n            console.timeEnd(input);\n    }\n}\n","// E621 API Endpoint Wrapper\n// Version 2.1\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Debug } from \"../utility/Debug\";\nimport { Util } from \"../utility/Util\";\n// All endpoints must be registered here.\n// Name is irrelevant, as long as it is unique.\n// Path is the endpoint address, without https://e621.net/\n// Don't forget to update the name in the E621 aliases below\nconst ENDPOINT_DEFS = [\n    { name: \"posts\", path: \"posts.json\", node: \"posts\" },\n    { name: \"post\", path: \"posts/%ID%.json\", node: \"post\" },\n    { name: \"post_votes\", path: \"posts/%ID%/votes.json\" },\n    { name: \"tags\", path: \"tags.json\" },\n    { name: \"tag\", path: \"tags/%ID%.json\" },\n    { name: \"tag_aliases\", path: \"tag_aliases.json\" },\n    { name: \"tag_implications\", path: \"tag_implications.json\" },\n    { name: \"notes\", path: \"notes.json\" },\n    { name: \"favorites\", path: \"favorites.json\", node: \"posts\" },\n    { name: \"favorite\", path: \"favorites/%ID%.json\" },\n    { name: \"pools\", path: \"pools.json\" },\n    { name: \"pool\", path: \"pools/%ID%.json\" },\n    { name: \"sets\", path: \"post_sets.json\" },\n    { name: \"set\", path: \"post_sets/%ID%.json\" },\n    { name: \"set_add_post\", path: \"post_sets/%ID%/add_posts.json\" },\n    { name: \"set_remove_post\", path: \"post_sets/%ID%/remove_posts.json\" },\n    { name: \"users\", path: \"users.json\" },\n    { name: \"user\", path: \"users/%ID%.json\" },\n    { name: \"blips\", path: \"blips.json\" },\n    { name: \"wiki_pages\", path: \"wiki_pages.json\" },\n    { name: \"comments\", path: \"comments.json\" },\n    { name: \"comment\", path: \"comments/%ID%.json\" },\n    { name: \"forum_posts\", path: \"forum_posts.json\" },\n    { name: \"forum_post\", path: \"forum_posts/%ID%.json\" },\n    { name: \"forum_topics\", path: \"forum_topics.json\" },\n    { name: \"forum_topic\", path: \"forum_topics/%ID%.json\" },\n    { name: \"dtext_preview\", path: \"dtext_preview\" },\n    { name: \"iqdb_queries\", path: \"iqdb_queries.json\" },\n];\nclass APIEndpoint {\n    constructor(queue, endpoint) {\n        this.queue = queue;\n        this.path = endpoint.path;\n        this.name = endpoint.name;\n        this.node = endpoint.node;\n    }\n    /**\n     * Set an endpoint parameter, if the current endpoint allows it.\n     * For example, to GET /users/12345.json, use E621.User.spec(\"12345\").get(...);\n     * @param param\n     */\n    id(param) {\n        this.param = param + \"\";\n        return this;\n    }\n    /**\n     * Send a GET request to the endpoint\n     * @param query Request query, either as a raw string or an APIQuery\n     * @param delay Optional delay override, in milliseconds\n     */\n    get(query, delay) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.queue.createRequest(this.getParsedPath(), this.formatParam(query), \"GET\", {}, this.name, this.node, delay).then((response) => {\n                const result = this.formatData(response[0], response[2]);\n                return Promise.resolve(result);\n            }, (response) => {\n                return Promise.reject(response[0]);\n            });\n        });\n    }\n    /**\n     * Sends a GET request to the endpoint, and returns the first result found.\n     * If no results are found, returns null.\n     * @param query Request query, either as a raw string or an APIQuery\n     * @param delay Optional delay override, in milliseconds\n     */\n    first(query, delay) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.get(query, delay).then((response) => {\n                if (response.length > 0)\n                    return Promise.resolve(response[0]);\n                else\n                    return Promise.resolve(null);\n            });\n        });\n    }\n    /**\n     * Send a POST request to the endpoint\n     * @param data Data to be sent with the request\n     * @param delay Optional delay override, in milliseconds\n     */\n    post(data, delay, noEncode) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.queue.createRequest(this.getParsedPath(), {}, \"POST\", this.formatParam(data, noEncode), this.name, this.node, delay).then((data) => {\n                return Promise.resolve(data);\n            }, (error) => { return Promise.reject(error); });\n        });\n    }\n    delete(data, delay) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.queue.createRequest(this.getParsedPath(), {}, \"DELETE\", this.formatParam(data), this.name, this.node, delay).then((data) => {\n                return Promise.resolve(data);\n            }, (error) => { return Promise.reject(error); });\n        });\n    }\n    put(data, delay) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.queue.createRequest(this.getParsedPath(), {}, \"PUT\", this.formatParam(data), this.name, this.node, delay).then((data) => {\n                return Promise.resolve(data);\n            }, (error) => { return Promise.reject(error); });\n        });\n    }\n    patch(data, delay) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.queue.createRequest(this.getParsedPath(), {}, \"PATCH\", this.formatParam(data), this.name, this.node, delay).then((data) => {\n                return Promise.resolve(data);\n            }, (error) => { return Promise.reject(error); });\n        });\n    }\n    /** Returns the endpoint path, accounting for the possible parameter */\n    getParsedPath() {\n        if (this.param) {\n            const output = this.path.replace(/%ID%/g, this.param);\n            this.param = undefined; // Clear the param to avoid contaminating the next query\n            return output;\n        }\n        return this.path;\n    }\n    /**\n     * Ensures that the provided APIQuery is in the correct format.\n     * Flattens objects and arrays in order to return a list of key-value pairs.\n     * @param input APIQuery to format\n     * @param noEncode If true, the values are not URI encoded\n     */\n    formatParam(input, noEncode = false) {\n        // Debug.log(\"input\", input);\n        if (input === undefined || input === null)\n            return {};\n        const response = {};\n        for (const [key, value] of Object.entries(input)) {\n            if (value === undefined || value === null)\n                continue;\n            if (Array.isArray(value)) {\n                for (const [index, elem] of value.entries())\n                    value[index] = cleanURIComponent(elem, noEncode);\n                response[key] = value.join(\"+\");\n            }\n            else if (typeof value == \"object\") {\n                for (const [subKey, subValue] of Object.entries(value)) {\n                    if (Array.isArray(subValue)) {\n                        for (const [index, subElement] of subValue.entries())\n                            subValue[index] = cleanURIComponent(subElement, noEncode);\n                        response[`${key}[${subKey}]`] = subValue.join(\"+\");\n                    }\n                    else\n                        response[`${key}[${subKey}]`] = cleanURIComponent(subValue, noEncode);\n                }\n            }\n            else {\n                response[key] = cleanURIComponent(value, noEncode);\n            }\n        }\n        // Debug.log(\"output\", response);\n        return response;\n        /** Prevent double-encoding the values */\n        function cleanURIComponent(value, noEncode) {\n            return noEncode ? encodeURIComponent(value + \"\") : encodeURIComponent(decodeURIComponent(value + \"\"));\n        }\n    }\n    /**\n     * Returns the correct data node depending on the endpoint's definition and parameter\n     * @param data Data to select the node from\n     * @param hasParam Whether or not the endpoint had a parameter\n     */\n    formatData(data, node) {\n        if (node !== undefined)\n            data = data[node];\n        if (Array.isArray(data))\n            return data;\n        else\n            return [data];\n    }\n}\nexport class E621 {\n    /** Constructor - should be kept private */\n    constructor() {\n        //used to notify the original request function of the requests completion\n        this.emitter = $({});\n        this.processing = false;\n        this.requestIndex = 0;\n        // Endpoint Definitions\n        this.endpoints = {};\n        this.authToken = $(\"head meta[name=csrf-token]\").attr(\"content\");\n        this.queue = [];\n        ENDPOINT_DEFS.forEach((definition) => {\n            this.endpoints[definition.name] = new APIEndpoint(this, definition);\n        });\n    }\n    /**\n     * Returns an endpoint by name.\n     * Names are defined in ENDPOINT_DEFS constant\n     * @param name Endpoint name\n     */\n    static getEndpoint(name) {\n        if (this.instance === undefined)\n            this.instance = new E621();\n        return this.instance.endpoints[name];\n    }\n    /**\n     * Adds a new request to the queue based on provided data.\n     * This should only be called from endpoint get() or post() methods.\n     * @param hasParam Whether or not the endpoint had a parameter\n     * @param path Endpoint path, i.e. posts.json\n     * @param query Raw query string, i.e. ?tags=horse,male,solo\n     * @param method Request method, either GET or POST\n     * @param data Data to POST\n     * @param delay How quickly the next request can be sent, in ms\n     */\n    createRequest(path, query, method, requestBody, endpoint, node, delay) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (delay === undefined)\n                delay = E621.requestRateLimit;\n            else if (delay < 500)\n                delay = 500;\n            const requestInfo = {\n                credentials: \"include\",\n                headers: {\n                    \"Content-Type\": \"application/x-www-form-urlencoded\",\n                    \"User-Agent\": window[\"re621\"][\"useragent\"],\n                    \"X-User-Agent\": window[\"re621\"][\"useragent\"],\n                },\n                method: method,\n                mode: \"cors\",\n            };\n            if (method !== \"GET\") {\n                this.authToken = $(\"meta[name=csrf-token]\").attr(\"content\");\n                requestBody[\"authenticity_token\"] = encodeURIComponent(this.authToken);\n                requestInfo.body = FormattedAPIQuery.stringify(requestBody);\n            }\n            // Append query parameters to the URL\n            query[\"_client\"] = window[\"re621\"][\"useragent\"];\n            const entry = new Request(location.origin + \"/\" + path + \"?\" + FormattedAPIQuery.stringify(query), requestInfo);\n            // console.log(path, requestInfo);\n            const index = this.requestIndex++;\n            const final = new Promise((resolve, reject) => {\n                this.emitter.one(\"api.re621.result-\" + index, (e, data, status, endpoint, node) => {\n                    // This happens if you use find() on an item that does not exist\n                    if (data === null)\n                        data = [];\n                    // This happens if you search for an item that does not exist through a query\n                    // Posts endpoint does not count, because it is one special little snowflake.\n                    if (data[endpoint] !== undefined && ![\"posts\", \"post\"].includes(endpoint))\n                        data = [];\n                    // \"Normal\" error handling\n                    if (data[\"error\"] === undefined)\n                        resolve([data, status, node]);\n                    else\n                        reject([data, status, node]);\n                });\n            });\n            this.add({ request: entry, index: index, delay: delay, endpoint: endpoint, node: node, });\n            return final;\n        });\n    }\n    /**\n     * Adds an item to the queue and starts processing it\n     * @param newItem Item to add\n     */\n    add(newItem) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.queue.push(newItem);\n            if (this.processing)\n                return;\n            this.processing = true;\n            while (this.queue.length > 0) {\n                const item = this.queue.shift();\n                Debug.connectLog(item.request.url);\n                yield new Promise((resolve) => __awaiter(this, void 0, void 0, function* () {\n                    fetch(item.request).then((response) => __awaiter(this, void 0, void 0, function* () {\n                        if (response.ok) {\n                            let responseText = yield response.text();\n                            if (!responseText)\n                                responseText = \"[]\";\n                            this.emitter.trigger(\"api.re621.result-\" + item.index, [\n                                JSON.parse(responseText),\n                                response.status,\n                                item.endpoint,\n                                item.node,\n                            ]);\n                        }\n                        else {\n                            this.emitter.trigger(\"api.re621.result-\" + item.index, [\n                                { error: response.status + \" \" + response.statusText },\n                                response.status,\n                                item.endpoint,\n                                item.node,\n                            ]);\n                        }\n                        resolve();\n                    }), (error) => {\n                        this.emitter.trigger(\"api.re621.result-\" + item.index, [\n                            { error: (error && error[0]) ? error[1] + \" \" + error[0].error : \"unknown error\" },\n                            (error && error[0]) ? error[1] : 500,\n                            item.endpoint,\n                            item.node,\n                        ]);\n                        resolve();\n                    });\n                }));\n                yield Util.sleep(item.delay);\n            }\n            this.processing = false;\n        });\n    }\n}\n// How often the script can send requests to the API, in milliseconds.\n// It can be as low as 500ms, but to stay on the safe side, we keep it at 1000.\nE621.requestRateLimit = 1000;\n// Endpoint Aliases\nE621.Posts = E621.getEndpoint(\"posts\");\nE621.Post = E621.getEndpoint(\"post\");\nE621.PostVotes = E621.getEndpoint(\"post_votes\");\nE621.Tags = E621.getEndpoint(\"tags\");\nE621.Tag = E621.getEndpoint(\"tag\");\nE621.TagAliases = E621.getEndpoint(\"tag_aliases\");\nE621.TagImplications = E621.getEndpoint(\"tag_implications\");\nE621.Notes = E621.getEndpoint(\"notes\");\nE621.Favorites = E621.getEndpoint(\"favorites\");\nE621.Favorite = E621.getEndpoint(\"favorite\");\nE621.Pools = E621.getEndpoint(\"pools\");\nE621.Pool = E621.getEndpoint(\"pool\");\nE621.Sets = E621.getEndpoint(\"sets\");\nE621.Set = E621.getEndpoint(\"set\");\nE621.SetAddPost = E621.getEndpoint(\"set_add_post\");\nE621.SetRemovePost = E621.getEndpoint(\"set_remove_post\");\nE621.Users = E621.getEndpoint(\"users\");\nE621.User = E621.getEndpoint(\"user\");\nE621.Blips = E621.getEndpoint(\"blips\");\nE621.Wiki = E621.getEndpoint(\"wiki_pages\");\nE621.Comments = E621.getEndpoint(\"comments\");\nE621.Comment = E621.getEndpoint(\"comment\");\nE621.ForumPosts = E621.getEndpoint(\"forum_posts\");\nE621.ForumPost = E621.getEndpoint(\"forum_post\");\nE621.ForumTopics = E621.getEndpoint(\"forum_topics\");\nE621.ForumTopic = E621.getEndpoint(\"forum_topic\");\nE621.DTextPreview = E621.getEndpoint(\"dtext_preview\");\nE621.IQDBQueries = E621.getEndpoint(\"iqdb_queries\");\n;\nvar FormattedAPIQuery;\n(function (FormattedAPIQuery) {\n    function stringify(input) {\n        const result = [];\n        for (const [key, value] of Object.entries(input))\n            result.push(key + \"=\" + value);\n        return result.join(\"&\");\n    }\n    FormattedAPIQuery.stringify = stringify;\n})(FormattedAPIQuery || (FormattedAPIQuery = {}));\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { E621 } from \"../api/E621\";\n/**\n * User\n * Basic framework for fetching user information from the page metadata\n */\nexport class User {\n    static init() {\n        const data = $(\"body\").data();\n        User.loggedIn = data.userIsAnonymous == false;\n        User.username = data.userName || \"Anonymous\";\n        User.userID = data.userId || -1;\n        User.level = data.userLevel || 0;\n        User.levelString = data.userLevelString || \"Anonymous\";\n        User.isMember = data.userIsMemeber == true;\n        User.isPrivileged = data.userIsPrivileged == true;\n        User.isContributor = data.userIsContributor == true;\n        User.isJanitor = data.userIsJanitor == true;\n        User.isModerator = data.userIsModerator == true;\n        User.isAdmin = data.userIsAdmin == true;\n        User.isFormerStaff = data.userIsFormerStaff == true;\n        User.isVoter = data.userIsVoter == true;\n        User.isVerified = data.userIsVerified == true;\n        User.isApprover = data.userIsApprover == true;\n        User.isBlocked = data.userIsBlocked == true;\n        User.isBanned = data.userIsBanned == true;\n        User.canApprovePosts = data.userCanApprovePosts == true;\n        User.canUploadFree = data.userCanUploadFree == true;\n        User.postsPerPage = data.userPerPage || 75;\n        User.commentThreshold = parseInt(getValue(\"user-comment-threshold\")) || 3;\n        User.blacklistedTags = getValue(\"blacklisted-tags\");\n        User.blacklistUsers = getValue(\"blacklist-users\") == \"true\";\n        User.enableJSNavigation = getValue(\"enable-js-navigation\") == \"true\";\n        User.enableAutoComplete = getValue(\"enable-auto-complete\") == \"true\";\n        User.styleUsernames = getValue(\"style-usernames\") == \"true\";\n        User.defaultImageSize = ImageScalingMode.get(getValue(\"default-image-size\"));\n        function getValue(name) {\n            const el = $(`meta[name=\"${name}\"]`);\n            if (el.length == 0)\n                return null;\n            return el.attr(\"content\");\n        }\n    }\n    /**\n     * @returns the users e6 site settings\n     */\n    static getCurrentSettings() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return E621.User.id(User.userID).first();\n        });\n    }\n    /**\n     * Saves the settings for the user\n     * There is no need to put the keys into array form, this happens automatically\n     */\n    static setSettings(data) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield E621.User.id(this.userID).post({ user: data, \"_method\": \"patch\" });\n        });\n    }\n}\nexport var ImageScalingMode;\n(function (ImageScalingMode) {\n    ImageScalingMode[\"Sample\"] = \"large\";\n    ImageScalingMode[\"FitHeight\"] = \"fitv\";\n    ImageScalingMode[\"FitWidth\"] = \"fit\";\n    ImageScalingMode[\"Original\"] = \"original\";\n})(ImageScalingMode || (ImageScalingMode = {}));\n(function (ImageScalingMode) {\n    function get(mode) {\n        switch (mode) {\n            case \"large\": return ImageScalingMode.Sample;\n            case \"fitv\": return ImageScalingMode.FitHeight;\n            case \"fit\": return ImageScalingMode.FitWidth;\n            case \"original\": return ImageScalingMode.Original;\n        }\n        return ImageScalingMode.Sample;\n    }\n    ImageScalingMode.get = get;\n})(ImageScalingMode || (ImageScalingMode = {}));\n","export class Page {\n    constructor() {\n        this.url = new URL(window.location.toString());\n    }\n    /**\n     * Checks if the url the user is currently on satisfies the filter\n     * @param filter Pipe separated list of filters the current location has to satisfy\n     *               Matches are by default on a startsWith basis, but if the url must match\n     *               you can prepend =\n     * @returns true if at least on filter is fulfilled\n     */\n    static matches(filter) {\n        if (filter instanceof RegExp)\n            filter = [filter];\n        const pathname = this.getInstance().url.pathname.replace(/[\\/?]$/g, \"\");\n        let result = false;\n        filter.forEach(function (constraint) {\n            result = result || constraint.test(pathname);\n        });\n        return result;\n    }\n    /** Returns a URL object */\n    static getURL() {\n        return this.getInstance().url;\n    }\n    /**\n     * Returns the query parameter, or null if the key does not exist\n     * @return string Query parameter\n     */\n    static getQueryParameter(key) {\n        return this.getInstance().url.searchParams.get(key);\n    }\n    /**\n     * Returns true if the search parameters has the provided key, false otherwise\n     * @param key\n     */\n    static hasQueryParameter(key) {\n        return this.getInstance().url.searchParams.has(key);\n    }\n    /**\n     * Sets a query parameter in the current url\n     * If there is already one with the same key, it will get overridden\n     * @param key\n     * @param value\n     */\n    static setQueryParameter(key, value) {\n        this.getInstance().url.searchParams.set(key, value);\n        this.refreshCurrentUrl();\n    }\n    /**\n     * Removes a querystring from the url\n     */\n    static removeQueryParameter(keys) {\n        if (!Array.isArray(keys))\n            keys = [keys];\n        for (const key of keys)\n            this.getInstance().url.searchParams.delete(key);\n        this.refreshCurrentUrl();\n    }\n    /**\n     * Replaces the current url without reloading or pushing the old one to the history\n     */\n    static refreshCurrentUrl() {\n        const url = this.getInstance().url;\n        const searchPrefix = url.searchParams.toString().length === 0 ? \"\" : \"?\";\n        history.replaceState({}, \"\", url.origin + url.pathname + searchPrefix + url.searchParams.toString() + url.hash);\n    }\n    /**\n     * Returns the name of the current site\n     * @returns e621 or e926\n     */\n    static getSiteName() {\n        return this.getInstance().url.hostname.replace(/\\.net/g, \"\");\n        ;\n    }\n    /**\n     * Returns the ID from the second part of the pathname\n     */\n    static getPageID() {\n        return this.getInstance().url.pathname.split(\"/\")[2];\n    }\n    /**\n     * Returns a singleton instance of the class\n     * @returns Url instance\n     */\n    static getInstance() {\n        if (this.instance === undefined)\n            this.instance = new Page();\n        return this.instance;\n    }\n    /**\n     * Returns the type of the page, according to the definitions below\n     * @returns Page type, as a string\n     */\n    static getPageType() {\n        for (const [name, regex] of Object.entries(PageDefinition))\n            if (Page.matches(regex))\n                return name;\n        return null;\n    }\n}\nexport const PageDefinition = {\n    title: /^(\\/)?$/,\n    search: /^\\/posts\\/?$/,\n    post: /^\\/posts\\/\\d+\\/?(show_seq)?$/,\n    upload: /\\/uploads\\/new\\/?/,\n    forum: /^\\/forum_topics\\/?.*/,\n    forumPost: /^\\/forum_topics\\/\\d+.*/,\n    pool: /^\\/pools\\/.+/,\n    set: /^\\/post_sets\\/.+/,\n    popular: /^\\/explore\\/posts\\/popular.?/,\n    favorites: /^\\/favorites\\/?.*/,\n    wiki: /^\\/wiki_pages\\/[0-9]+/,\n    wikiNA: /^\\/wiki_pages\\/show_or_new.*/,\n    artist: /^\\/artists\\/[0-9]+/,\n    comments: /^\\/comments\\??.*/,\n    settings: /^\\/users\\/\\.+\\/edit$/,\n    changes: /^\\/post_versions.*/,\n    tickets: /^\\/tickets.*/,\n    profile: /^\\/users\\/.+$/,\n    iqdb: /^\\/iqdb_queries.*/,\n    deleted_posts: /^\\/deleted_posts.*/,\n    blips: /^\\/blips.*/,\n    help: /^\\/help.*/,\n    postConfirmDelete: /^\\/moderator\\/post\\/posts\\/.+\\/confirm_delete.*/,\n};\n","import { Page } from \"../data/Page\";\nimport { Util } from \"../utility/Util\";\nexport default class DOMTools {\n    /**\n     * Adds the given style to the document and returns the injected style element\n     * @param css string CSS styles\n     */\n    static addStyle(css) {\n        return $(\"<style>\")\n            .attr({\n            \"id\": Util.ID.make(),\n            \"type\": \"text/css\"\n        })\n            .html(css)\n            .appendTo(\"head\");\n    }\n    static patchHeader() {\n        const $menuContainer = $(\"nav#nav\");\n        const $menuMain = $(\"menu.main\");\n        if ($(\"#nav\").find(\"menu\").length < 2) {\n            $(\"<menu>\")\n                .addClass(\"subnav\")\n                .appendTo($menuContainer);\n        }\n        else\n            $(\"#nav menu\").last().addClass(\"subnav\");\n        // Replace the logo in menu.main with a separate element\n        $(\"<menu>\")\n            .addClass(\"logo\")\n            .html(`<a href=\"/\">${Page.getSiteName()}</a>`)\n            .prependTo($menuContainer);\n        $menuMain.find(\"#nav-e\").remove();\n        // Add a section for re621 settings buttons\n        $(\"<menu>\")\n            .addClass(\"extra\")\n            .insertAfter($menuMain);\n    }\n    static setupDialogContainer() {\n        $(\"<div>\")\n            .attr(\"id\", \"modal-container\")\n            .prependTo(\"body\");\n    }\n    /**\n     * Adds a button to the top-right of the navbar\n     * @param config Button configuration\n     * @param target Target element\n     */\n    static addSettingsButton(config, target = \"menu.extra\") {\n        if (config.name === undefined)\n            config.name = \"T\";\n        if (config.href === undefined)\n            config.href = \"\";\n        if (config.title === undefined)\n            config.title = \"\";\n        if (config.tabClass === undefined)\n            config.tabClass = \"\";\n        if (config.linkClass === undefined)\n            config.linkClass = \"\";\n        if (config.attr === undefined)\n            config.attr = {};\n        const $tab = $(`<li>`).appendTo(target);\n        const $link = $(\"<a>\")\n            .html(config.name)\n            .attr({\n            \"title\": config.title,\n            \"id\": config.id,\n        })\n            .appendTo($tab);\n        if (config.onClick !== undefined)\n            $link.on(\"click\", () => { config.onClick($link); });\n        if (config.href) {\n            $link.attr(\"href\", config.href);\n        }\n        if (config.tabClass) {\n            $tab.addClass(config.tabClass);\n        }\n        if (config.linkClass) {\n            $link.addClass(config.linkClass);\n        }\n        if (config.attr) {\n            $link.attr(config.attr);\n        }\n        return $link;\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport class PageObserver {\n    /**\n     * Initialize the observer and start watching for DOM changes.\n     * Should be executed as soon as possible\n     */\n    static init() {\n        if (this.observer && this.targets)\n            return;\n        // Watch for the elements to load\n        this.targets = new Map();\n        this.observer = new MutationObserver(() => {\n            for (const [selector, callback] of Array.from(this.targets.entries())) {\n                if (!document.querySelector(selector))\n                    continue;\n                this.targets.delete(selector);\n                callback(true);\n            }\n        });\n        this.observer.observe(document, { childList: true, subtree: true });\n        // Clean up after the page loads\n        $(() => {\n            this.observer.disconnect();\n            this.pageLoaded = true;\n            for (const callback of Array.from(this.targets.values()))\n                callback(false);\n            this.targets = new Map();\n        });\n    }\n    /**\n     * Waits for the DOM element to load in.\n     * Returns a promise that resolves to true if the element is found,\n     * and to false if the page fully loads without encountering the element.\n     * @param selector Element to search for\n     * @returns Promise\n     */\n    static watch(selector) {\n        if ($(selector).length > 0)\n            return Promise.resolve(true);\n        else if (this.pageLoaded)\n            return Promise.resolve(false);\n        return new Promise((resolve) => {\n            this.targets.set(selector, resolve);\n        });\n    }\n    /** Returns a promise that gets resolved if and when the window is visible on the screen */\n    static awaitFocus() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve) => {\n                // Document either has direct user focus, or is generally visible on the screen\n                if (document.hasFocus() || document.visibilityState == \"visible\") {\n                    resolve(true);\n                    return;\n                }\n                // Window receives focus\n                $(window).one(\"focus\", () => resolve(true));\n            });\n        });\n    }\n}\nPageObserver.pageLoaded = false;\n","import { Util } from \"../utility/Util\";\nexport class Modal {\n    constructor(config) {\n        // private config: ModalConfig;\n        this.triggers = [];\n        this.isDisabled = false;\n        this.id = Util.ID.make();\n        config = this.validateConfig(config);\n        this.triggersMulti = config.triggerMulti;\n        this.isDisabled = config.disabled;\n        // Create the DOM structure for the modal window\n        this.$modal = $(\"<div>\")\n            .attr(\"title\", config.title)\n            .append(config.content)\n            .dialog({\n            autoOpen: config.autoOpen,\n            appendTo: \"#modal-container\",\n            resizable: false,\n            width: \"auto\",\n            minWidth: config.minWidth,\n            minHeight: config.minHeight,\n            position: {\n                my: config.position.my,\n                at: config.position.at,\n                of: \"#modal-container\",\n                within: \"#modal-container\",\n                // collision: \"none\",\n            },\n            classes: {\n                \"ui-dialog\": \"bg-foreground border-section color-text\",\n                \"ui-dialog-titlebar\": \"color-text\",\n                \"ui-dialog-titlebar-close\": \"border-foreground\",\n            }\n        });\n        const ui = this.$modal.closest('.ui-dialog');\n        ui.draggable('option', 'containment', '#modal-container');\n        // Replace the modal structure on window open, if necessary\n        if (config.structure)\n            this.$modal.one(\"dialogopen.lazyload\", () => {\n                this.$modal.html(\"\");\n                this.$modal.append(config.structure.render());\n            });\n        this.registerTrigger(config.triggers);\n    }\n    enable() { this.isDisabled = false; }\n    disable() { this.isDisabled = true; }\n    get isOpen() { return this.$modal.dialog(\"isOpen\"); }\n    set isOpen(open) { this.$modal.dialog(open ? \"open\" : \"close\"); }\n    open() { this.isOpen = true; }\n    close() { this.isOpen = false; }\n    toggle() { this.isOpen = !this.isOpen; }\n    /**\n     * Parses the configuration and sets the default values for missing entries\n     * @param config Configuration to parse\n     */\n    validateConfig(config) {\n        const result = {};\n        result.title = typeof config.title === \"undefined\" ? \"Dialog\" : config.title;\n        result.autoOpen = typeof config.autoOpen === \"undefined\" ? false : config.autoOpen;\n        result.triggers = typeof config.triggers === \"undefined\" ? [] : config.triggers;\n        result.triggerMulti = typeof config.triggerMulti === \"undefined\" ? false : config.triggerMulti;\n        result.content = typeof config.content === \"undefined\" ? $(\"\") : config.content;\n        result.structure = typeof config.structure === \"undefined\" ? null : config.structure;\n        result.minWidth = typeof config.minWidth === \"undefined\" ? 150 : config.minWidth;\n        result.minHeight = typeof config.minHeight === \"undefined\" ? 150 : config.minHeight;\n        result.disabled = typeof config.disabled === \"undefined\" ? false : config.disabled;\n        if (typeof config.position === \"undefined\")\n            result.position = { my: \"center\", at: \"center\" };\n        else\n            result.position = {\n                my: !config.position.my ? \"center\" : config.position.my,\n                at: !config.position.at ? \"center\" : config.position.at,\n            };\n        return result;\n    }\n    /**\n     * Appends more content to the modal\n     * @param $content Content to add\n     */\n    addContent($content) {\n        this.$modal.append($content);\n    }\n    /**\n     * Sets the modal content\n     * @param $content Content to add\n     */\n    setContent($content) {\n        this.$modal.html(\"\");\n        this.$modal.append($content);\n    }\n    /**\n     * Listens to the specified element in order to trigger the modal\n     * @param trigger Element-event pair to listen to\n     */\n    registerTrigger(trigger) {\n        if (!trigger)\n            return;\n        else if (Array.isArray(trigger)) {\n            for (const one of trigger)\n                this.registerTrigger(one);\n            return;\n        }\n        if (typeof trigger.event === \"undefined\")\n            trigger.event = \"click\";\n        if (this.triggers.length == 0)\n            this.activeTrigger = trigger.element;\n        this.triggers.push(trigger);\n        trigger.element.on(trigger.event + \".re621.dialog-\" + this.id, (event) => {\n            if (this.isDisabled)\n                return;\n            event.preventDefault();\n            const $target = $(event.currentTarget);\n            if (this.triggersMulti && !this.activeTrigger.is($target) && this.isOpen) {\n                this.toggle(); // TODO Update the modal window instead of toggling\n            }\n            this.activeTrigger = $target;\n            this.toggle();\n            return false;\n        });\n    }\n    clearTriggers() {\n        for (const trigger of this.triggers)\n            trigger.element.off(trigger.event + \".re621.dialog-\" + this.id);\n        this.triggers = [];\n    }\n    getElement() { return this.$modal; }\n    /**\n     * Completely and irreversibly destroys the modal window\n     */\n    destroy() {\n        this.$modal.dialog(\"destroy\");\n        this.$modal.remove();\n    }\n    /**\n     * Returns the element that triggered the modal\n     * @returns JQuery<HTMLElement> trigger\n     */\n    getActiveTrigger() {\n        return this.activeTrigger;\n    }\n}\nModal.isReady = false;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport Script from \"../../models/Script\";\nimport { Modal } from \"../structure/Modal\";\nimport { PageObserver } from \"../structure/PageObserver\";\nexport class ErrorHandler {\n    static log(module, message, error) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const notice = $(\"<div>\").html([\n                `<p>RE621 had encountered an error during script execution.</p>`,\n                `<p>Please, report this message, including the error log below, through the <a href=\"${Script.url.issues}\">issue tracker</a>, or in the <a href=\"${Script.url.thread}\">forum thread</a>.</p>`,\n            ].join(\"\\n\"));\n            const textarea = $(\"<textarea>\").val([\n                `RE621 v.${Script.version} for ${Script.handler.name} v.${Script.handler.version}`,\n                window.navigator.userAgent,\n                message,\n                (error && error.stack) ? error.stack : error,\n            ].join(\"\\n\"));\n            console.error([\n                \"[ErrorHandler]\",\n                notice.text().trim(),\n                (textarea.val() + \"\").trim(),\n            ].join(\"\\n\"));\n            if (!Modal.isReady)\n                yield PageObserver.watch(\"modal-container\");\n            const dialog = new Modal({\n                title: \"Error\",\n                autoOpen: true,\n                // width: window.innerWidth / 2,\n                // height: window.innerHeight / 2,\n                // minWidth: 400,\n                // minHeight: 400,\n                // maxWidth: 800,\n                // maxHeight: 600,\n            });\n            dialog.getElement()\n                .addClass(\"error-handler\")\n                .append(notice)\n                .append(textarea);\n        });\n    }\n}\n","import { Debug } from \"../utility/Debug\";\nimport { Util } from \"../utility/Util\";\nconst validKeys = [\n    \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"0\",\n    \"-\", \"=\", \".\", \",\", \"/\", \";\", \"'\", \"[\", \"]\",\n    \"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\",\n    \"escape\", \"ctrl\", \"alt\", \"shift\", \"return\",\n    \"up\", \"down\", \"left\", \"right\",\n];\nconst replacedKeys = {\n    // event.key returns a different name to what jquery.hotkeys expects\n    \"enter\": \"return\",\n    \"control\": \"ctrl\",\n    \"arrow\": \"\",\n    // replacing shift-modified symbols with respective values\n    // it makes no practical difference, but it looks neater\n    \"!\": \"1\", \"@\": \"2\", \"#\": \"3\", \"$\": \"4\", \"%\": \"5\",\n    \"^\": \"6\", \"&\": \"7\", \"*\": \"8\", \"(\": \"9\", \")\": \"0\",\n    \"_\": \"-\", \"+\": \"=\", \"<\": \",\", \">\": \".\", \"?\": \"//\",\n    \":\": \";\", '\"': \"'\", \"{\": \"[\", \"}\": \"]\",\n};\nconst replacedRegExp = Util.getKeyRegex(replacedKeys);\nexport class KeybindManager {\n    static enable() { KeybindManager.enabled = true; }\n    static disable() { KeybindManager.enabled = false; }\n    static block() { KeybindManager.blocked = true; }\n    static register(keybind) {\n        if (KeybindManager.blocked)\n            return;\n        if (Array.isArray(keybind)) {\n            for (const entry of keybind)\n                this.register(entry);\n            return;\n        }\n        // Create a listener if one does not exist already\n        this.refreshListener(keybind.keys, keybind.element, keybind.selector);\n        // Register the keybind function in the executor\n        for (const key of keybind.keys) {\n            if (key.length == 0)\n                continue;\n            this.executors.get(key)[keybind.bindMeta] = keybind;\n        }\n    }\n    static unregister(bindMeta) {\n        if (!Array.isArray(bindMeta))\n            bindMeta = [bindMeta];\n        for (const executor of this.executors.values())\n            for (const key of Object.keys(executor))\n                if (bindMeta.includes(key))\n                    delete executor[key];\n    }\n    static record(callback) {\n        KeybindManager.listening = true;\n        let keys = [];\n        $(document).on(\"keydown.re621.record\", (event) => {\n            const key = event.key\n                .toLowerCase()\n                .replace(replacedRegExp, (matched) => {\n                return replacedKeys[matched];\n            });\n            if (validKeys.indexOf(key) == -1)\n                return;\n            keys.push(key);\n        });\n        $(document).on(\"keyup.re621.record\", () => {\n            if (keys.length !== 0) {\n                $(document).off(\".re621.record\");\n                callback(keys);\n                KeybindManager.listening = false;\n                return;\n            }\n            keys = [];\n        });\n    }\n    static count(sequence) {\n        if (!this.executors.has(sequence))\n            return 0;\n        return Object.keys(this.executors.get(sequence)).length;\n    }\n    static refreshListener(keys, element, selector) {\n        for (const key of keys) {\n            if (key.length == 0)\n                continue;\n            // Establish the listener structure\n            if (!this.listeners.has(key)) {\n                let keydown = false;\n                this.listeners.set(key, (event) => {\n                    if (KeybindManager.listening)\n                        return;\n                    const listenerExecutor = this.executors.get(key);\n                    Debug.log(`[${key}]: triggered ${Object.entries(listenerExecutor).length} executors`);\n                    for (const [bindMeta, keyObj] of Object.entries(listenerExecutor)) {\n                        // If the keybind is outright disable, skip\n                        if (!keyObj.enabled)\n                            continue;\n                        // This is a dumb solution, but it'll work for the time being\n                        // The issue is that any keybind can be made holdable by binding it\n                        // to a the same key as an already holdable key. This may allow\n                        // people to spam certain actions.\n                        if (keyObj.holdable)\n                            keydown = false;\n                        // Execute the keybind function\n                        keyObj.fnct(event, bindMeta);\n                    }\n                });\n                // Create the listener itself\n                const $element = element ? $(element) : $(document);\n                if (!selector)\n                    selector = null;\n                let cooldown = null;\n                $element.on(\"keydown.re621.hotkey-\" + key, selector, key, (event) => {\n                    if (keydown)\n                        return;\n                    if (cooldown)\n                        return;\n                    keydown = true;\n                    if (!KeybindManager.enabled || KeybindManager.listening)\n                        return false;\n                    Debug.log(`[${key}]: caught`);\n                    this.listeners.get(key)(event);\n                    // Slightly throttles the keystroke input speed\n                    // Should only be an issue with holdable keybinds\n                    clearTimeout(cooldown);\n                    cooldown = setTimeout(() => {\n                        clearTimeout(cooldown);\n                        cooldown = null;\n                    }, 50);\n                });\n                $element.on(\"keyup.re621.hotkey-\" + key, selector, key, () => {\n                    keydown = false;\n                });\n                $(window).on(\"blur\", () => {\n                    keydown = false;\n                });\n            }\n            // Create the executor\n            if (!this.executors.has(key))\n                this.executors.set(key, {});\n        }\n    }\n}\nKeybindManager.listeners = new Map();\nKeybindManager.executors = new Map();\nKeybindManager.enabled = true; // if false, stops executor functions from running\nKeybindManager.blocked = false; // if true, stops listener functions from being created\nKeybindManager.listening = false; // same as enabled, but for internal use only\n","import { XM } from \"../api/XM\";\nimport { KeybindManager } from \"../data/Keybinds\";\nimport { Util } from \"../utility/Util\";\n/**\n * Form Engine v.2.0\n * Simplifies the process of creating complex, visually consistent forms.\n */\nexport class Form {\n    /**\n     * Prepares the form structure and settings.\n     * Use `get()` to return an actual DOM element.\n     * @param options Form options\n     * @param content Form elements\n     * @param onSubmit Form submission callback\n     */\n    constructor(options, content, onSubmit) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        if (!options.columns)\n            options.columns = 1;\n        if (!options.width)\n            options.width = options.columns;\n        this.element = $(\"<form>\")\n            .addClass(\"form-section\" + (options.wrapper ? \" \" + options.wrapper : \"\"))\n            .attr({\n            \"id\": options.name,\n            \"columns\": options.columns !== 1 ? options.columns : null,\n            \"formspan\": options.width !== 1 ? options.width : null,\n        })\n            .on(\"submit\", (event) => {\n            event.preventDefault();\n            const values = {};\n            this.inputList.forEach((input, name) => {\n                if (input.attr(\"type\") == \"checkbox\")\n                    values[name] = input.is(\":checked\");\n                else\n                    values[name] = input.val().toString();\n            });\n            onSubmit(values, this);\n        });\n        this.content = content;\n        this.inputList = new Map();\n    }\n    /**\n     * Builds and returns the form DOM element\n     * @param force If true, ignores any cached data and rebuilds the structure from scratch\n     */\n    render(force = false) {\n        if (this.created && !force) {\n            return this.element;\n        }\n        // Build form elements\n        this.element[0].innerHTML = \"\";\n        const formID = this.element.attr(\"id\");\n        for (const entry of this.content) {\n            for (const childElem of entry.build(formID, force))\n                childElem.appendTo(this.element);\n        }\n        // Compile input lists\n        for (const entry of this.content) {\n            for (const input of entry.getInputs()) {\n                const name = input.attr(\"name\");\n                if (name !== undefined)\n                    this.inputList.set(name, input);\n            }\n        }\n        // Return the form element\n        this.created = true;\n        return this.element;\n    }\n    /**\n     * Resets the elements to their default values.\n     * Does not include buttons and submit elements\n     */\n    reset() {\n        this.inputList.forEach((input) => {\n            const defval = input.attr(\"defval\");\n            if (defval !== undefined) {\n                if (input.attr(\"type\") == \"checkbox\")\n                    input.prop(\"checked\", defval == \"true\");\n                else\n                    input.val(defval);\n            }\n        });\n    }\n    /**\n     * Returns a list of elements in the form.\n     * If no parameter is specified, returns all inputs\n     * @param names Names of inputs to return\n     */\n    getInputList(...names) {\n        if (names.length == 0) {\n            return this.inputList;\n        }\n        const results = new Map();\n        this.inputList.forEach((input, name) => {\n            if (names.includes(name))\n                results.set(name, input);\n        });\n        return results;\n    }\n    /**\n     * An empty, placeholder form. Used to properly space out and center modals\n     * @param width Form width\n     */\n    static placeholder(width = 1) {\n        return new Form({ columns: width, width: width }, [Form.spacer(width)]).render();\n    }\n    /**\n     * Creates a form section FormElement based on the provided parameters\n     * @param options Section configuration\n     * @param content Form elements\n     */\n    static section(options, content) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        if (!options.columns)\n            options.columns = 1;\n        if (!options.width)\n            options.width = options.columns;\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = $(\"<form-section>\")\n            .toggleClass(options.wrapper, options.wrapper)\n            .attr({\n            \"id\": options.name,\n            \"labeled\": options.label !== undefined ? \"\" : null,\n            \"columns\": options.columns !== 1 ? options.columns : null,\n            \"colspan\": options.width !== 1 ? options.width : null,\n        });\n        return new FormElement($element, undefined, $label, content);\n    }\n    /**\n     * Creates a collapsible section FormElement based on the provided parameters\n     * @param options Section configuration\n     * @param content Form elements\n     */\n    static accordion(options, content) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        if (!options.columns)\n            options.columns = 1;\n        if (!options.width)\n            options.width = options.columns;\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = $(\"<form-accordion>\")\n            .toggleClass(options.wrapper, options.wrapper)\n            .attr({\n            \"id\": options.name,\n            \"labeled\": options.label !== undefined ? \"\" : null,\n            \"columns\": options.columns !== 1 ? options.columns : null,\n            \"colspan\": options.width !== 1 ? options.width : null,\n        });\n        return new FormElement($element, undefined, $label, content, undefined, (postElement) => {\n            postElement.accordion({\n                active: options.active,\n                animate: false,\n                collapsible: options.collapsible === true,\n                header: \"form-header\",\n            });\n            // Accordions fail to properly show visible elements\n            postElement.find(\"form-section[aria-hidden=false]\").css(\"display\", \"\");\n        });\n    }\n    static accordionTab(options, content) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        if (!options.columns)\n            options.columns = 1;\n        if (!options.width)\n            options.width = options.columns;\n        const $label = $(\"<form-header>\")\n            .attr(\"for\", options.name)\n            .html(options.label || \"TITLE_ERROR\");\n        if (options.subheader)\n            $(\"<span>\")\n                .addClass(\"form-collapse-subheader\")\n                .append(options.subheader)\n                .appendTo($label);\n        if (options.badge)\n            $(\"<span>\")\n                .addClass(\"form-collapse-badge\")\n                .append(options.badge)\n                .appendTo($label);\n        const $element = $(\"<form-section>\")\n            .addClass(\"collapse-content\")\n            .attr({\n            \"id\": options.name,\n            \"labeled\": options.label !== undefined ? \"\" : null,\n            \"columns\": options.columns !== 1 ? options.columns : null,\n            \"colspan\": options.width !== 1 ? options.width : null,\n        });\n        return new FormElement($element, undefined, $label, content);\n    }\n    /**\n     * Creates a collapsible section FormElement based on the provided parameters\n     * @param options Section configuration\n     * @param content Form elements\n     */\n    static collapse(options, content, onActivate) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        if (!options.columns)\n            options.columns = 1;\n        if (!options.width)\n            options.width = options.columns;\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = $(\"<form-collapse>\")\n            .attr({\n            \"id\": options.name,\n            \"colspan\": options.width || 1,\n        });\n        const header = $(\"<h3>\")\n            .addClass(\"collapse-header\")\n            .html(options.title || \"Details\")\n            .appendTo($element);\n        if (options.badge)\n            $(\"<span>\")\n                .addClass(\"form-collapse-badge\")\n                .append(options.badge)\n                .appendTo(header);\n        const container = $(\"<form-section>\")\n            .addClass(\"collapse-content\")\n            .attr({\n            \"labeled\": options.label !== undefined ? \"\" : null,\n            \"columns\": options.columns !== 1 ? options.columns : null,\n            \"colspan\": options.width !== 1 ? options.width : null,\n        })\n            .appendTo($element);\n        $element.accordion({\n            active: !options.collapsed,\n            animate: false,\n            collapsible: true,\n            header: \"h3\",\n            beforeActivate: () => {\n                if (onActivate == undefined)\n                    return;\n                onActivate(header.attr(\"id\"), header.attr(\"aria-expanded\") == \"true\");\n            },\n        });\n        return new FormElement($element, undefined, $label, content, container);\n    }\n    /**\n     * Creates an input FormElement based on the provided parameters\n     * @param options Element configuration\n     * @param changed Input change callback\n     */\n    static input(options, changed) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils\n            .makeInputWrapper(options.label, options.wrapper, options.width);\n        const $input = $(\"<input>\")\n            .attr({\n            \"type\": \"text\",\n            \"id\": options.name,\n            \"name\": options.name,\n        })\n            .addClass(\"bg-section color-text\")\n            .prop(\"disabled\", options.disabled == true)\n            .appendTo($element);\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($input);\n                    break;\n                }\n                case \"object\": {\n                    $input.val(options.value.text());\n                    break;\n                }\n                case \"boolean\":\n                    options.value = options.value + \"\";\n                default: {\n                    $input\n                        .val(options.value)\n                        .attr(\"defval\", options.value);\n                }\n            }\n        }\n        if (options.title)\n            $input.attr(\"title\", options.title);\n        if (options.pattern)\n            $input.attr(\"pattern\", options.pattern);\n        if (options.required)\n            $input.attr(\"required\", '');\n        if (changed !== undefined) {\n            let timer;\n            $input.on(\"input\", () => {\n                if (timer)\n                    clearTimeout(timer);\n                timer = window.setTimeout(() => { changed($input.val().toString(), $input); }, Form.inputTimeout);\n            });\n        }\n        return new FormElement($element, $input, $label);\n    }\n    /**\n     * Creates an input FormElement based on the provided parameters\n     * @param options Element configuration\n     * @param changed Input change callback\n     */\n    static textarea(options, changed) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils\n            .makeInputWrapper(options.label, options.wrapper, options.width);\n        const $input = $(\"<textarea>\")\n            .attr({\n            \"type\": \"text\",\n            \"id\": options.name,\n            \"name\": options.name,\n        })\n            .addClass(\"bg-section color-text\")\n            .prop(\"disabled\", options.disabled == true)\n            .appendTo($element);\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($input);\n                    break;\n                }\n                case \"object\": {\n                    $input.val(options.value.text());\n                    break;\n                }\n                case \"boolean\":\n                    options.value = options.value + \"\";\n                default: {\n                    $input\n                        .val(options.value)\n                        .attr(\"defval\", options.value);\n                }\n            }\n        }\n        if (options.title)\n            $input.attr(\"title\", options.title);\n        if (options.pattern)\n            $input.attr(\"pattern\", options.pattern);\n        if (options.required)\n            $input.attr(\"required\", '');\n        if (changed !== undefined) {\n            let timer;\n            $input.on(\"input\", () => {\n                if (timer)\n                    clearTimeout(timer);\n                timer = window.setTimeout(() => { changed($input.val().toString(), $input); }, Form.inputTimeout);\n            });\n        }\n        return new FormElement($element, $input, $label);\n    }\n    /**\n     * Creates a copy input FormElement based on the provided parameters\n     * @param options Element configuration\n     */\n    static copy(options) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils\n            .makeInputWrapper(options.label, options.wrapper, options.width)\n            .addClass(\"copybox\");\n        const $input = $(\"<input>\")\n            .attr({\n            \"type\": \"text\",\n            \"id\": options.name,\n            \"readonly\": \"\",\n        })\n            .addClass(\"bg-section color-text\")\n            .appendTo($element);\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($input);\n                    break;\n                }\n                case \"object\": {\n                    $input.val(options.value.text());\n                    break;\n                }\n                case \"boolean\":\n                    options.value = options.value + \"\";\n                default: {\n                    $input\n                        .val(options.value)\n                        .attr(\"defval\", options.value);\n                }\n            }\n        }\n        const $copyButton = $(\"<button>\")\n            .attr({\n            \"type\": \"button\",\n            \"id\": options.name + \"-copy\",\n        })\n            .addClass(\"button btn-neutral border-highlight border-left\")\n            .html(`<i class=\"far fa-copy\"></i>`)\n            .appendTo($element);\n        if (options.title) {\n            $input.attr(\"title\", options.title);\n            $copyButton.attr(\"title\", options.title);\n        }\n        let copyTimer;\n        $($copyButton).on(\"click\", () => {\n            XM.Util.setClipboard($input.val());\n            window.clearTimeout(copyTimer);\n            $input.addClass(\"highlight\");\n            copyTimer = window.setTimeout(() => $input.removeClass(\"highlight\"), 250);\n        });\n        return new FormElement($element, $input, $label);\n    }\n    /**\n     * Creates a key input FormElement based on the provided parameters\n     * @param options Element configuration\n     */\n    static key(options, changed) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils\n            .makeInputWrapper(options.label, options.wrapper, options.width)\n            .addClass(\"keyinput\");\n        const $input = $(\"<input>\")\n            .attr({\n            \"type\": \"text\",\n            \"id\": options.name,\n            \"readonly\": \"\",\n        })\n            .addClass(\"bg-section color-text\")\n            .appendTo($element);\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($input);\n                    break;\n                }\n                case \"object\": {\n                    $input.val(options.value.text());\n                    break;\n                }\n                case \"boolean\":\n                    options.value = options.value + \"\";\n                default: {\n                    $input\n                        .val(options.value)\n                        .attr(\"defval\", options.value);\n                }\n            }\n            $input.attr(\"key\", $input.val() + \"\");\n        }\n        const $warning = $(\"<span>\")\n            .addClass(\"keyinput-warning\")\n            .attr(\"title\", \"Duplicate Keybinding\")\n            .appendTo($element);\n        if (KeybindManager.count($input.val() + \"\") <= 1)\n            $warning.addClass(\"display-none\");\n        const $recordButton = $(\"<button>\")\n            .attr({\n            \"type\": \"button\",\n            \"id\": options.name + \"-key\",\n        })\n            .addClass(\"button btn-neutral border-highlight border-left\")\n            .html(`<i class=\"far fa-keyboard\"></i>`)\n            .appendTo($element);\n        if (options.title) {\n            $input.attr(\"title\", options.title);\n            $recordButton.attr(\"title\", options.title);\n        }\n        let occupied = false;\n        $($recordButton).on(\"click\", () => {\n            if (occupied)\n                return;\n            occupied = true;\n            const duplicates = $(`.keyinput input[key=\"${$input.val()}\"]`);\n            if (duplicates.length > 2) {\n                $warning.addClass(\"display-none\");\n            }\n            else {\n                duplicates\n                    .parent()\n                    .find(\"span.keyinput-warning\")\n                    .addClass(\"display-none\");\n            }\n            $input\n                .addClass(\"input-info\")\n                .val(\"Recording\");\n            KeybindManager.record((sequence) => {\n                if (sequence.includes(\"escape\")) {\n                    $input\n                        .removeClass(\"input-info\")\n                        .val(\"\")\n                        .attr(\"key\", \"\");\n                    if (changed !== undefined)\n                        changed(\"\", $input);\n                    occupied = false;\n                }\n                else {\n                    const newVal = flattenSequence(sequence);\n                    $input\n                        .removeClass(\"input-info\")\n                        .val(newVal)\n                        .attr(\"key\", newVal);\n                    const duplicates = $(`.keyinput input[key=\"${newVal}\"]`);\n                    if (duplicates.length > 1) {\n                        duplicates\n                            .parent()\n                            .find(\"span.keyinput-warning\")\n                            .removeClass(\"display-none\");\n                    }\n                    if (changed !== undefined)\n                        changed(newVal, $input);\n                    occupied = false;\n                }\n            });\n        });\n        return new FormElement($element, $input, $label);\n        // If a modifier key is pressed, the hotkey library will\n        // add it to every element of the sequence. Since we are\n        // flattening the sequence anyways, it should be safe to\n        // get rid of them altogether.\n        function flattenSequence(input) {\n            input = input.join(\"+\").split(\"+\");\n            input = [...new Set(input)];\n            return input.join(\"+\");\n        }\n    }\n    /**\n     * Creates a file input FormElement based on the provided parameters\n     * @param options Element configuration\n     */\n    static file(options, changed) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils\n            .makeInputWrapper(options.label, options.wrapper, options.width)\n            .addClass(\"fileinput\");\n        const $input = $(\"<input>\")\n            .attr({\n            \"type\": \"file\",\n            \"accept\": options.accept,\n            \"id\": options.name,\n        })\n            .addClass(\"bg-section color-text\")\n            .prop(\"disabled\", options.disabled == true)\n            .appendTo($element);\n        if (options.title)\n            $input.attr(\"title\", options.title);\n        if (changed !== undefined) {\n            $input.on(\"change\", () => {\n                changed($input.prop(\"files\"), $input);\n            });\n        }\n        return new FormElement($element, $input, $label);\n    }\n    static icon(options, content, changed) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils.makeInputWrapper(options.label, options.wrapper, options.width);\n        const $input = $(\"<input>\")\n            .attr({\n            \"type\": \"text\",\n            \"id\": options.name,\n            \"name\": options.name,\n        })\n            .css(\"display\", \"none\")\n            .appendTo($element);\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($input);\n                    break;\n                }\n                case \"object\": {\n                    $input.val(options.value.text());\n                    break;\n                }\n                case \"boolean\":\n                    options.value = options.value + \"\";\n                default: {\n                    $input\n                        .val(options.value)\n                        .attr(\"defval\", options.value);\n                }\n            }\n        }\n        const $selectContainer = $(\"<div>\")\n            .addClass(\"icon-picker\")\n            .appendTo($element);\n        for (const key in content) {\n            $(\"<a>\")\n                .attr(\"href\", \"#\")\n                .attr(\"data-value\", key)\n                .html(content[key] ? (\"&#x\" + content[key]) : \"&nbsp;\")\n                .appendTo($selectContainer);\n        }\n        $selectContainer.find(\"a\").on(\"click\", (event) => {\n            event.preventDefault();\n            $selectContainer.find(\"a\").removeClass(\"active\");\n            const $target = $(event.target);\n            $input.val($target.attr(\"data-value\"));\n            $target.addClass(\"active\");\n            if (changed)\n                changed($input.val().toString(), $input);\n        });\n        if (options.value) {\n            $selectContainer.find(\"a[data-value='\" + options.value + \"']\").first().trigger(\"click\");\n        }\n        else {\n            $selectContainer.find(\"a\").first().trigger(\"click\");\n        }\n        // When the field value is set externally, this event needs to be triggered on the text input field.\n        // There is probably a better way to do this, but this should work for now.\n        $input.on(\"re621:form:update\", () => {\n            console.log(\"updating\", $input.val());\n            if ($input.val() == \"\") {\n                $selectContainer.find(\"a\").first().trigger(\"click\");\n            }\n            else {\n                $selectContainer.find(\"a[data-value='\" + $input.val() + \"']\").first().trigger(\"click\");\n            }\n        });\n        return new FormElement($element, $input, $label);\n    }\n    /**\n     * Creates a button FormElement based on the provided parameters\n     * @param options Element configuration\n     * @param changed Input change callback\n     */\n    static button(options, changed) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils\n            .makeInputWrapper(options.label, options.wrapper, options.width);\n        const $input = $(\"<button>\")\n            .attr({\n            \"id\": options.name,\n            \"type\": options.type ? options.type : \"button\",\n        })\n            .addClass(\"button btn-neutral\")\n            .prop(\"disabled\", options.disabled == true)\n            .appendTo($element);\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($input);\n                    break;\n                }\n                case \"object\": {\n                    $input.append(options.value);\n                    break;\n                }\n                case \"number\":\n                case \"boolean\":\n                    options.value = options.value + \"\";\n                default: {\n                    $input\n                        .html(options.value)\n                        .attr(\"defval\", options.value);\n                }\n            }\n        }\n        if (options.title)\n            $input.attr(\"title\", options.title);\n        if (changed !== undefined)\n            $input.on(\"click\", (event) => {\n                event.preventDefault();\n                changed(true, $input);\n            });\n        return new FormElement($element, $input, $label);\n    }\n    /**\n     * Creates a checkbox FormElement based on the provided parameters\n     * @param options Element configuration\n     * @param changed Input change callback\n     */\n    static checkbox(options, changed) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        const $element = FormUtils\n            .makeInputWrapper(undefined, options.wrapper, options.width)\n            .addClass(\"checkbox-switch\")\n            .toggleClass(\"input-disabled\", options.disabled == true);\n        const $input = $(\"<input>\")\n            .attr({\n            \"id\": options.name,\n            \"name\": options.name,\n            \"type\": \"checkbox\",\n        })\n            .addClass(\"switch\")\n            .prop(\"disabled\", options.disabled == true)\n            .appendTo($element);\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($input);\n                    break;\n                }\n                case \"object\": {\n                    break;\n                }\n                default: {\n                    $input\n                        .prop(\"checked\", options.value)\n                        .attr(\"defval\", options.value + \"\");\n                }\n            }\n        }\n        $(\"<label>\")\n            .attr(\"for\", options.name)\n            .addClass(\"switch\")\n            .appendTo($element);\n        if (options.label) {\n            $(\"<label>\")\n                .attr(\"for\", options.name)\n                .html(options.label)\n                .appendTo($element);\n        }\n        if (changed !== undefined)\n            $input.on(\"change\", () => { changed($input.is(\":checked\"), $input); });\n        return new FormElement($element, $input);\n    }\n    /**\n     * Creates a select FormElement based on the provided parameters\n     * @param options Element configuration\n     * @param content Select options data\n     * @param changed Input change callback\n     */\n    static select(options, content, changed) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils\n            .makeInputWrapper(options.label, options.wrapper, options.width);\n        const $input = $(\"<select>\")\n            .attr({\n            \"id\": options.name,\n            \"name\": options.name,\n        })\n            .addClass(\"button btn-neutral\")\n            .prop(\"disabled\", options.disabled == true)\n            .appendTo($element);\n        if (content !== undefined) {\n            if (typeof content === \"function\")\n                content = content();\n            for (const key in content)\n                $(\"<option>\").val(key).text(content[key]).appendTo($input);\n        }\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($input);\n                    break;\n                }\n                case \"object\": {\n                    $input.val(options.value.text());\n                    break;\n                }\n                case \"boolean\":\n                    options.value = options.value + \"\";\n                default: {\n                    $input\n                        .val(options.value)\n                        .attr(\"defval\", options.value);\n                }\n            }\n        }\n        if (options.title)\n            $input.attr(\"title\", options.title);\n        if (changed !== undefined)\n            $input.on(\"change\", () => { changed($input.val().toString(), $input); });\n        return new FormElement($element, $input, $label);\n    }\n    /**\n     * Creates a header FormElement based on the provided parameters\n     * @param text Header text\n     * @param width Element span\n     */\n    static header(text, width) {\n        const $element = FormUtils.makeInputWrapper(undefined, undefined, width);\n        $(\"<h3>\")\n            .attr(\"id\", Util.ID.make())\n            .addClass(\"color-text\")\n            .html(text)\n            .appendTo($element);\n        return new FormElement($element);\n    }\n    /**\n     * Creates a div FormElement based on the provided parameters\n     * @param options Element configuration\n     */\n    static div(options) {\n        if (!options.name)\n            options.name = Util.ID.make();\n        let $label;\n        if (options.label)\n            $label = FormUtils.makeLabel(options.name, options.label);\n        const $element = FormUtils\n            .makeInputWrapper(options.label, options.wrapper, options.width)\n            .addClass(\"text-div\")\n            .attr(\"id\", options.name);\n        if (options.value !== undefined && options.value !== null) {\n            switch (typeof options.value) {\n                case \"function\": {\n                    options.value($element);\n                    break;\n                }\n                case \"object\": {\n                    $element.append(options.value);\n                    break;\n                }\n                case \"number\":\n                case \"boolean\":\n                    options.value = options.value + \"\";\n                default: {\n                    $element.html(options.value);\n                }\n            }\n        }\n        return new FormElement($element, undefined, $label);\n    }\n    /**\n     * Alias for `Form.div` with streamlined options\n     * @param text Div contents\n     * @param width Wrapper width\n     */\n    static text(text, width = 1, wrapper) {\n        return Form.div({ value: text, width: width, wrapper: wrapper });\n    }\n    static requiresReload() {\n        return Form.text(`<div class=\"text-center text-bold\">Requires a page reload</div>`, 1, \"align-middle\");\n    }\n    /**\n     * Alias for `Form.div` with some pre-built markup\n     * @param header First line of the header\n     * @param subheader Second line of the header\n     * @param width Wrapper width\n     */\n    static subheader(header, subheader, width = 1, name, wrapper) {\n        return Form.div({ value: `<b>${header}</b><br />${subheader}`, width: width, wrapper: \"subheader\" + (wrapper ? \" \" + wrapper : \"\"), name: name });\n    }\n    /**\n     * Creates an hr FormElement based on the provided parameters\n     * @param width Element width\n     */\n    static hr(width) {\n        const $element = FormUtils.makeInputWrapper(undefined, undefined, width);\n        $(\"<hr>\")\n            .attr(\"id\", Util.ID.make())\n            .addClass(\"color-text-muted\")\n            .appendTo($element);\n        return new FormElement($element);\n    }\n    /**\n     * Creates an empty spacer element\n     * @param width Element width\n     */\n    static spacer(width, unmargin = false) {\n        const $element = FormUtils.makeInputWrapper(undefined, undefined, width);\n        $(\"<spacer>\")\n            .attr(\"id\", Util.ID.make())\n            .toggleClass(\"unmargin\", unmargin)\n            .appendTo($element);\n        return new FormElement($element);\n    }\n}\nForm.inputTimeout = 500; // Typing timeout on text input fields\nclass FormUtils {\n    static makeLabel(name, text) {\n        return $(\"<label>\")\n            .attr(\"for\", name)\n            .html(text);\n    }\n    static makeInputWrapper(label, wrapper, width = 1) {\n        return $(\"<form-input>\")\n            .addClass(wrapper ? \" \" + wrapper : \"\")\n            .attr({\n            \"labeled\": label !== undefined ? \"\" : null,\n            \"colspan\": width !== 1 ? width : null,\n        });\n    }\n}\nexport class FormElement {\n    /**\n     * Constructs a form element based on provided data.\n     * Only the `wrapper` parameter is required, everything else is optional.\n     * @param wrapper Element that wraps the rest of the inputs\n     * @param input Input element, if there is one\n     * @param label Input label, if there is one\n     * @param content Contains other FormElements that need to be built and appended to this element\n     * @param container Container object for content. If omitted, defaults to wrapper\n     * @param postProcessing Function to run after the object has been built. Takes the wrapper as a parameter.\n     */\n    constructor(wrapper, input, label, content, container, postProcessing) {\n        this.wrapper = wrapper;\n        this.input = input;\n        this.label = label;\n        this.content = content ? content : [];\n        this.container = container ? container : wrapper;\n        this.postProcessing = postProcessing ? postProcessing : () => { return; };\n    }\n    getInput() {\n        return this.input;\n    }\n    getInputs() {\n        const result = [];\n        if (this.input)\n            result.push(this.input);\n        for (const entry of this.content)\n            result.push(...entry.getInputs());\n        return result;\n    }\n    build(parentID, force = false) {\n        if (force || !this.created) {\n            for (const entry of this.content) {\n                for (const childElem of entry.build(parentID + \"-\" + this.wrapper.attr(\"id\"), force))\n                    childElem.appendTo(this.container);\n            }\n            if (this.label !== undefined)\n                this.label.attr(\"for\", parentID + \"-\" + this.label.attr(\"for\"));\n            if (this.input !== undefined)\n                this.input.attr(\"id\", parentID + \"-\" + this.input.attr(\"id\"));\n            switch (this.wrapper.prop(\"tagName\")) {\n                case \"FORM-INPUT\": {\n                    if (this.wrapper.attr(\"id\"))\n                        this.wrapper.attr(\"id\", parentID + \"-\" + this.wrapper.attr(\"id\"));\n                    for (const label of this.wrapper.find(\"> label\")) {\n                        const $subLabel = $(label);\n                        $subLabel.attr(\"for\", parentID + \"-\" + $subLabel.attr(\"for\"));\n                    }\n                    break;\n                }\n                case \"FORM-SECTION\":\n                case \"FORM-ACCORDION\": {\n                    this.wrapper.attr(\"id\", parentID + \"-\" + this.wrapper.attr(\"id\"));\n                    break;\n                }\n            }\n            this.postProcessing(this.wrapper);\n            this.created = true;\n        }\n        if (this.label)\n            return [this.label, this.wrapper];\n        else\n            return [this.wrapper];\n    }\n}\nclass FormAccordionElement extends FormElement {\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { XM } from \"../components/api/XM\";\nimport { Page } from \"../components/data/Page\";\nimport { PageObserver } from \"../components/structure/PageObserver\";\nimport { ErrorHandler } from \"../components/utility/ErrorHandler\";\nexport default class Component {\n    constructor(options = {}) {\n        this.initialized = false; // Whether or not the component is currently running\n        this.eventIndex = 0; // Used to provide IDs to the component event listeners\n        // Component settings\n        // The Settings object defines default values and is used to access them via dynamic setters and getters\n        // The SettingsCache object stores the current values of the settings\n        this.Settings = {\n            enabled: true,\n        };\n        // Validate the options\n        if (options.name)\n            this.name = options.name;\n        else\n            this.name = this.constructor.name;\n        if (!options.constraint)\n            options.constraint = [];\n        else if (!Array.isArray(options.constraint))\n            options.constraint = [options.constraint];\n        this.constraintMatches = options.constraint.length == 0 || Page.matches(options.constraint);\n        if (!options.waitForDOM)\n            options.waitForDOM = false;\n        this.DOMLoadConditions = options.waitForDOM;\n        // TODO options.dependencies\n        // Initialize the settings cache\n        this.SettingsCache = {\n            enabled: true,\n        };\n        // Being component initialization\n        this.execPrepare()\n            .then(() => this.bootstrapSettings())\n            .then(() => {\n            // Check if page constraints match\n            if (!this.constraintMatches)\n                return;\n            // Determine when to create the DOM structure\n            if (typeof options.waitForDOM == \"string\") {\n                PageObserver.watch(options.waitForDOM).then((status) => {\n                    if (!status) {\n                        // TODO Page loaded, but the element was not found\n                        return;\n                    }\n                    this.execCreate();\n                });\n            }\n            else if (options.waitForDOM) {\n                $(() => this.execCreate());\n            }\n            else\n                this.execCreate();\n        });\n    }\n    /** Loads the settings from storage, and sets up listeners to sync them across tabs */\n    bootstrapSettings() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Load in the saved settings values\n            for (const [key, defaultValue] of Object.entries(this.Settings)) {\n                const savedValue = yield XM.Storage.getValue(this.name + \".\" + key, defaultValue);\n                this.SettingsCache[key] = savedValue;\n                // This is a hack, but I'm not sure how else I'm supposed\n                // to pass a reference to the parent object inside the\n                // dynamic getter / setter setup below.\n                // eslint-disable-next-line @typescript-eslint/no-this-alias\n                const passedThis = this;\n                // Define custom setters and getters\n                Object.defineProperty(this.Settings, key, {\n                    get() {\n                        return passedThis.SettingsCache[key];\n                    },\n                    set(newValue) {\n                        passedThis.SettingsCache[key] = newValue;\n                        console.log(JSON.stringify(newValue), JSON.stringify(defaultValue), JSON.stringify(newValue) == JSON.stringify(defaultValue));\n                        if (JSON.stringify(newValue) == JSON.stringify(defaultValue))\n                            XM.Storage.deleteValue(passedThis.name + \".\" + key);\n                        else\n                            XM.Storage.setValue(passedThis.name + \".\" + key, newValue);\n                    }\n                });\n                // Sync settings between tabs\n                XM.Storage.addListener(this.name + \".\" + key, (settingsTag, oldValue, newValue, remote) => {\n                    if (remote)\n                        this.SettingsCache[key] = newValue;\n                    this.trigger(\"settings.\" + key + (remote ? \".remote\" : \".local\"), newValue);\n                });\n            }\n            // Example of a settings listener.\n            // Loads the component if it's enabled, unloads it if it's disabled.\n            this.on(\"settings.enabled\", (value) => {\n                if (value)\n                    this.load();\n                else\n                    this.unload();\n            });\n        });\n    }\n    /**\n     * Loads the component's functionality.\n     * Aborted if some of the load conditions do not match.\n     */\n    load() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Check if page constraints match\n            if (!this.constraintMatches)\n                return;\n            // Determine when to create the DOM structure\n            if (typeof this.DOMLoadConditions == \"string\") {\n                PageObserver.watch(this.DOMLoadConditions).then((status) => {\n                    if (!status) {\n                        // TODO Page loaded, but the element was not found\n                        return;\n                    }\n                    this.execCreate();\n                });\n            }\n            else if (this.DOMLoadConditions) {\n                $(() => this.execCreate());\n            }\n            else\n                this.execCreate();\n            this.trigger(\"load\");\n        });\n    }\n    /** Unloads the component's functionality and returns the DOM to its original state */\n    unload() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.execDestroy();\n            this.trigger(\"unload\");\n        });\n    }\n    /** Restarts the component. Shorthand for running `unload()` and `load()`. */\n    reload() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.unload();\n            yield this.load();\n        });\n    }\n    /**\n     * Loads necessary component data.\n     * Executed before any initialization occurs, and runs even if the load conditions do not match\n     */\n    prepare() {\n        return __awaiter(this, void 0, void 0, function* () { });\n    }\n    /** Runs the component's `prepare()` function and loads settings */\n    execPrepare() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this.prepare();\n            }\n            catch (error) {\n                // TODO Error handling\n            }\n            this.trigger(\"prepare\");\n        });\n    }\n    /**\n     * Creates the component's DOM structure.\n     * Executed as soon as the load conditions match.\n     */\n    create() {\n        return __awaiter(this, void 0, void 0, function* () { });\n    }\n    /** Runs the component's `create()` function, sets corresponding variables and triggers events. */\n    execCreate() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.initialized) {\n                // TODO Throw an error?\n                return;\n            }\n            try {\n                yield this.create();\n            }\n            catch (error) {\n                ErrorHandler.log(`[${this.name}] fatal crash during initialization`, error);\n                return;\n            }\n            this.initialized = true;\n            this.trigger(\"create\");\n        });\n    }\n    /**\n     * Completely removes the component's DOM structure and restores the original state.\n     * Typically executed when a component is disabled.\n     */\n    destroy() {\n        return __awaiter(this, void 0, void 0, function* () { });\n    }\n    execDestroy() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.initialized) {\n                // TODO Throw an error?\n                return;\n            }\n            try {\n                yield this.destroy();\n            }\n            catch (error) {\n                // TODO Error handling\n            }\n            this.initialized = false;\n            this.trigger(\"destroy\");\n        });\n    }\n    /** Execute all handlers for the specified component event */\n    trigger(event, data) {\n        $(document).trigger(`re621.${this.name}.${event}`, data);\n    }\n    /**\n     * Attach a handler function for the specified event to the component\n     * @returns Event ID, unique to this component, that can be used to unbind this handler\n     */\n    on(event, handler) {\n        $(document).on(`re621.${this.name}.${event}.${this.eventIndex}`, handler);\n        return this.eventIndex++;\n    }\n    /** Executes a handler function exactly once whe encountering a specified event */\n    one(event, handler) {\n        $(document).one(`re621.${this.name}.${event}`, handler);\n    }\n    /** Detaches handlers from the specified component event */\n    off(event, eventID) {\n        $(document).off(`re621.${this.name}.${event}` + (eventID ? `.${eventID}` : \"\"));\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Page } from \"../../components/data/Page\";\nimport { User } from \"../../components/data/User\";\nimport { Form } from \"../../components/structure/Form\";\nimport { Modal } from \"../../components/structure/Modal\";\nimport { Util } from \"../../components/utility/Util\";\nimport Component from \"../Component\";\n/**\n * HeaderCustomizer\n * Add, remove, and re-arrange the tabs in the customizable navbar\n */\nexport class HeaderCustomizer extends Component {\n    constructor() {\n        super({ waitForDOM: \"menu.extra\" });\n        this.editingMode = false;\n        this.Settings = {\n            enabled: true,\n            hotkeyTab1: \"1\",\n            hotkeyTab2: \"2\",\n            hotkeyTab3: \"3\",\n            hotkeyTab4: \"4\",\n            hotkeyTab5: \"5\",\n            hotkeyTab6: \"6\",\n            hotkeyTab7: \"7\",\n            hotkeyTab8: \"8\",\n            hotkeyTab9: \"9\",\n            tabs: [\n                { name: \"Profile\", href: \"/users/%userID%\" },\n                { name: \"Posts\", href: \"/posts\" },\n                { name: \"Comments\", href: \"/comments?group_by=post\" },\n                { name: \"Artists\", href: \"/artists\" },\n                { name: \"Tags\", href: \"/tags\" },\n                { name: \"Blips\", href: \"/blips\" },\n                { name: \"Pools\", href: \"/pools\" },\n                { name: \"Sets\", href: \"/post_sets\" },\n                { name: \"Wiki\", href: \"/wiki_pages?title=help:home\" },\n                { name: \"Forum\", href: \"/forum_topics\" },\n                { name: \"Discord\", href: \"/static/discord\" },\n                { name: \"Help\", href: \"/help\" },\n                { name: \"More \", href: \"/static/site_map\" },\n            ],\n            forumUpdateDot: true,\n        };\n        /*\n        this.registerHotkeys(\n            { keys: \"hotkeyTab1\", fnct: () => { HeaderCustomizer.openTabNum(0); } },\n            { keys: \"hotkeyTab2\", fnct: () => { HeaderCustomizer.openTabNum(1); } },\n            { keys: \"hotkeyTab3\", fnct: () => { HeaderCustomizer.openTabNum(2); } },\n            { keys: \"hotkeyTab4\", fnct: () => { HeaderCustomizer.openTabNum(3); } },\n            { keys: \"hotkeyTab5\", fnct: () => { HeaderCustomizer.openTabNum(4); } },\n            { keys: \"hotkeyTab6\", fnct: () => { HeaderCustomizer.openTabNum(5); } },\n            { keys: \"hotkeyTab7\", fnct: () => { HeaderCustomizer.openTabNum(6); } },\n            { keys: \"hotkeyTab8\", fnct: () => { HeaderCustomizer.openTabNum(7); } },\n            { keys: \"hotkeyTab9\", fnct: () => { HeaderCustomizer.openTabNum(8); } },\n        );\n        */\n    }\n    get isEditing() { return this.editingMode; }\n    set isEditing(value) {\n        this.editingMode = value;\n        if (value) {\n            this.$menu.attr(\"data-editing\", \"true\");\n            this.$menu.sortable(\"enable\");\n            this.addTabModal.open();\n            this.updateTabModal.enable();\n        }\n        else {\n            this.$menu.attr(\"data-editing\", \"false\");\n            this.$menu.sortable(\"disable\");\n            this.addTabModal.close();\n            this.updateTabModal.close();\n            this.updateTabModal.disable();\n        }\n    }\n    /**\n     * Creates the module's structure.\n     * Should be run immediately after the constructor finishes.\n     */\n    create() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Check for forum updates before the structure changes\n            this.hasForumUpdates = $(\"li#nav-forum\").hasClass(\"forum-updated\");\n            // Create the structure and store the old navbar for later\n            this.$menu = $(\"menu.main\");\n            this.$oldMenu = $(\"<div>\").css(\"display\", \"none\").appendTo(\"body\");\n            this.$menu.children().appendTo(this.$oldMenu);\n            this.$menu.addClass(\"custom\");\n            // Load stored data\n            this.rebuildTabs();\n            this.toggleForumDot(this.Settings.forumUpdateDot);\n            this.createConfigInterface();\n            this.$menu.sortable({\n                axis: \"x\",\n                containment: \"parent\",\n                helper: \"clone\",\n                forceHelperSize: true,\n                opacity: 0.75,\n                cursor: \"grabbing\",\n                disabled: true,\n                update: () => {\n                    this.reloadTabMargins();\n                    this.saveNavbarSettings();\n                },\n            });\n            // Listen to settings events and update the structure\n            this.on(\"settings.tabs.remote\", () => {\n                this.isEditing = false;\n                this.rebuildTabs();\n                this.updateTabModal.clearTriggers();\n                this.updateTabModal.registerTrigger({ element: $(\"menu.main li a\") });\n            });\n            this.on(\"settings.forumUpdateDot.remote\", () => {\n                this.toggleForumDot(this.Settings.forumUpdateDot);\n            });\n        });\n    }\n    destroy() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.$menu.removeClass(\"custom\").empty();\n            this.$menu.sortable(\"destroy\");\n            this.addTabButton.remove();\n            this.addTabModal.destroy();\n            this.updateTabModal.destroy();\n            this.$oldMenu.children().appendTo(this.$menu);\n            this.$oldMenu.remove();\n        });\n    }\n    /** Creates the configuration forms and modals */\n    createConfigInterface() {\n        // === Tab Configuration Interface\n        this.addTabButton = Util.DOM.addSettingsButton({\n            id: \"header-button-customizer\",\n            name: `<i class=\"fas fa-tasks\"></i>`,\n            title: \"Edit Header Tabs\",\n            tabClass: \"float-left\",\n            onClick: () => { this.isEditing = !this.isEditing; }\n        });\n        const newTabForm = new Form({ name: \"header-customizer-new\" }, [\n            Form.input({ label: \"Name\", name: \"name\", value: \"\", required: true, pattern: \"[\\\\S ]+\" }),\n            Form.input({ label: \"Hover\", value: \"\", name: \"title\" }),\n            Form.input({ label: \"Link\", value: \"\", name: \"href\" }),\n            Form.checkbox({ label: \"Attach to the right side\", value: false, name: \"right\" }),\n            Form.button({ value: \"Submit\", type: \"submit\" }),\n            Form.hr(),\n            Form.div({ value: \"Available variables:\" }),\n            Form.copy({ label: \"Unique ID\", value: \"%userID%\" }),\n            Form.copy({ label: \"Username\", value: \"%username%\" }),\n            Form.hr(),\n            Form.div({ value: \"Drag-and-drop tabs to re-arrange.<br />Click on a tab to edit it.\" }),\n        ], (values, form) => {\n            this.addTab({\n                name: values[\"name\"],\n                title: values[\"title\"],\n                href: values[\"href\"],\n                right: values[\"right\"],\n            });\n            form.reset();\n            this.reloadTabMargins();\n        });\n        this.addTabModal = new Modal({\n            title: \"Add Tab\",\n            content: Form.placeholder(),\n            structure: newTabForm,\n            position: { my: \"right top\", at: \"right top\" }\n        });\n        this.addTabModal.getElement().on(\"dialogclose\", () => { this.isEditing = false; });\n        // Tab Update Interface\n        this.updateTabForm = new Form({ name: \"header-customizer-update\" }, [\n            Form.input({ label: \"Name\", name: \"name\", value: \"\", required: true, pattern: \"[\\\\S ]+\" }),\n            Form.input({ label: \"Hover\", value: \"\", name: \"title\" }),\n            Form.input({ label: \"Link\", value: \"\", name: \"href\" }),\n            Form.checkbox({ label: \"Attach to the right side\", value: false, name: \"right\" }),\n            Form.button({ value: \"Delete\", type: \"button\" }, () => {\n                this.deleteTab(this.updateTabModal.getActiveTrigger().parent());\n                this.updateTabModal.close();\n            }),\n            Form.button({ value: \"Update\", type: \"submit\" }),\n        ], (values, form) => {\n            this.updateTab(this.updateTabModal.getActiveTrigger().parent(), {\n                name: values[\"name\"],\n                title: values[\"title\"],\n                href: values[\"href\"],\n                right: values[\"right\"],\n            });\n            this.updateTabModal.close();\n            form.reset();\n            this.reloadTabMargins();\n        });\n        this.updateTabModal = new Modal({\n            title: \"Update Tab\",\n            triggers: [{ element: $(\"menu.main li a\") }],\n            content: Form.placeholder(),\n            structure: this.updateTabForm,\n            position: { my: \"center top\", at: \"center top\" },\n            triggerMulti: true,\n            disabled: true,\n        });\n        // Fill in update tab data\n        this.updateTabModal.getElement().on(\"dialogopen\", () => {\n            const $tab = this.updateTabModal.getActiveTrigger().parent();\n            const $updateTabInputs = this.updateTabForm.getInputList();\n            $updateTabInputs.get(\"name\").val($tab.data(\"tab.name\"));\n            $updateTabInputs.get(\"title\").val($tab.data(\"tab.title\"));\n            $updateTabInputs.get(\"href\").val($tab.data(\"tab.href\"));\n            $updateTabInputs.get(\"right\").prop(\"checked\", $tab.data(\"tab.right\"));\n        });\n    }\n    rebuildTabs() {\n        this.$menu.html(\"\");\n        for (const value of this.Settings.tabs)\n            this.createTabElement(value);\n        this.reloadTabMargins();\n    }\n    /** Toggles the red dot next to the forum tab */\n    toggleForumDot(state) {\n        this.$menu.attr(\"data-forumdot\", \"\" + state);\n    }\n    /**\n     * Creates a new styled tab\n     * @param config Tab configuration\n     */\n    createTabElement(config, triggerUpdate = false) {\n        config = this.parseHeaderTabConfig(config);\n        const $tab = $(`<li>`)\n            .data({\n            \"tab.name\": config.name,\n            \"tab.title\": config.title,\n            \"tab.href\": config.href,\n            \"tab.right\": config.right,\n        })\n            .attr(\"align\", config.right ? \"true\" : undefined)\n            .appendTo(this.$menu);\n        const $link = $(\"<a>\")\n            .html(this.processTabVariables(config.name))\n            .appendTo($tab);\n        if (config.title !== \"\")\n            $link.attr(\"title\", this.processTabVariables(config.title));\n        if (config.href !== \"\")\n            $link.attr(\"href\", this.processTabVariables(config.href));\n        if (config.href === \"/forum_topics\" && this.hasForumUpdates)\n            $link.addClass(\"tab-has-updates\");\n        else if ((config.href == \"/users/%userID%\" || config.href == \"/users/home\") && !User.loggedIn) {\n            $link\n                .attr(\"href\", \"/session/new\")\n                .addClass(\"tab-login\")\n                .html(\"Sign In\");\n        }\n        if (triggerUpdate) {\n            this.saveNavbarSettings();\n        }\n        if (config.href.trim() !== \"\" && Page.getURL().pathname.includes(this.processTabVariables(config.href).split(\"?\")[0])) {\n            $tab.addClass(\"bg-foreground\");\n        }\n        return { tab: $tab, link: $link };\n    }\n    /**\n     * Parses the provided configuration file for missing values\n     * @param config Configuration to process\n     */\n    parseHeaderTabConfig(config) {\n        if (config.name === undefined)\n            config.name = \"New Tab\";\n        if (config.href === undefined)\n            config.href = \"\";\n        if (config.title === undefined)\n            config.title = \"\";\n        if (config.right === undefined)\n            config.right = false;\n        return config;\n    }\n    /**\n     * Creates a new tab based on specified configuration\n     * @param config Configuration\n     */\n    addTab(config) {\n        config = this.parseHeaderTabConfig(config);\n        const newTab = this.createTabElement(config, true);\n        this.updateTabModal.registerTrigger({ element: newTab.link });\n    }\n    /**\n     * Update the specified tab with the corresponding configuration\n     * @param $element Tab to update\n     * @param config New configuration\n     */\n    updateTab($element, config) {\n        config = this.parseHeaderTabConfig(config);\n        $element\n            .data({\n            \"tab.name\": config.name,\n            \"tab.title\": config.title,\n            \"tab.href\": config.href,\n            \"tab.right\": config.right,\n        })\n            .removeAttr(\"align\")\n            .attr(\"align\", config.right ? \"true\" : undefined);\n        $element.find(\"a\").first()\n            .html(this.processTabVariables(config.name))\n            .attr(\"title\", this.processTabVariables(config.title))\n            .attr(\"href\", this.processTabVariables(config.href));\n        this.saveNavbarSettings();\n    }\n    /**\n     * Remove the specified tab\n     * @param $element LI element of the tab\n     */\n    deleteTab($element) {\n        $element.remove();\n        this.saveNavbarSettings();\n    }\n    /**\n     * Replaces the variables in the text with corresponding values\n     * @param text Text to parse\n     */\n    processTabVariables(text) {\n        return text\n            .replace(/%userID%/gi, User.userID + \"\")\n            .replace(/%username%/gi, User.username);\n    }\n    /**\n     * Iterates over the header menu and saves the data to cookies\n     */\n    saveNavbarSettings() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tabData = [];\n            this.$menu.find(\"li\").each(function (i, element) {\n                const $tab = $(element);\n                tabData.push({\n                    name: formatVal($tab.data(\"tab.name\")),\n                    title: formatVal($tab.data(\"tab.title\")),\n                    href: formatVal($tab.data(\"tab.href\")),\n                    right: $tab.data(\"tab.right\") ? true : undefined,\n                });\n            });\n            this.Settings.tabs = tabData;\n            function formatVal(value) {\n                if (value)\n                    return value;\n                return undefined;\n            }\n        });\n    }\n    /** Emulates a click on the header tab with the specified index */\n    /*\n    private static openTabNum(num: number): void {\n        const tabs = ModuleController.get(HeaderCustomizer).$menu.find<HTMLElement>(\"li > a\");\n        if (num > tabs.length) return;\n        tabs[num].click();\n    }\n    */\n    /** Refreshes the right-aligned tabs to have proper margins */\n    reloadTabMargins() {\n        this.$menu.children(\"li\").removeClass(\"margined\");\n        this.$menu.find(\"li[align=true]\")\n            .first()\n            .addClass(\"margined\");\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Form } from \"../../components/structure/Form\";\nimport { Modal } from \"../../components/structure/Modal\";\nimport { Util } from \"../../components/utility/Util\";\nimport Component from \"../Component\";\nexport class ThemeCustomizer extends Component {\n    create() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const openCustomizerButton = Util.DOM.addSettingsButton({\n                id: \"header-button-theme\",\n                name: `<i class=\"fas fa-paint-brush\"></i>`,\n                title: \"Change Theme\",\n            });\n            // === Establish the settings window contents\n            const form = new Form({ name: \"theme-customizer\" }, [\n                Form.select({\n                    label: \"Theme\",\n                    name: \"th-main\",\n                    value: (element) => {\n                        this.$main = element;\n                        element.val(window.localStorage.getItem(\"theme\") || \"hexagon\");\n                    },\n                }, {\n                    \"hexagon\": \"Hexagon\",\n                    \"pony\": \"Pony\",\n                    \"bloodlust\": \"Bloodlust\",\n                    \"serpent\": \"Serpent\",\n                    \"hotdog\": \"Hotdog\",\n                }, (data) => {\n                    Util.LS.setItem(\"theme\", data);\n                    $(\"body\").attr(\"data-th-main\", data);\n                    this.trigger(\"switch.theme\", data);\n                }),\n                Form.select({\n                    label: \"Extras\",\n                    name: \"th-extra\",\n                    value: (element) => {\n                        this.$extra = element;\n                        element.val(window.localStorage.getItem(\"theme-extra\") || \"hexagons\");\n                    },\n                }, {\n                    \"none\": \"None\",\n                    \"aurora\": \"Aurora\",\n                    \"autumn\": \"Autumn\",\n                    \"hexagon\": \"Hexagon\",\n                    \"space\": \"Space\",\n                    \"spring\": \"Spring\",\n                    \"stars\": \"Stars\",\n                    \"winter\": \"Winter\",\n                }, (data) => {\n                    Util.LS.setItem(\"theme-extra\", data);\n                    $(\"body\").attr(\"data-th-extra\", data);\n                    this.trigger(\"switch.extras\", data);\n                }),\n                Form.select({\n                    label: \"Post Navbar\",\n                    name: \"th-nav\",\n                    value: (element) => {\n                        this.$nav = element;\n                        element.val(Util.LS.getItem(\"theme-nav\") || \"top\");\n                    },\n                }, {\n                    \"top\": \"Top\",\n                    \"bottom\": \"Bottom\",\n                    \"both\": \"Both\",\n                    \"left\": \"Sidebar\",\n                    \"none\": \"None\",\n                }, (data) => {\n                    Util.LS.setItem(\"theme-nav\", \"top\");\n                    $(\"body\").attr(\"data-th-nav\", data);\n                    this.trigger(\"switch.navbar\", data);\n                }),\n            ]);\n            // === Create the modal\n            new Modal({\n                title: \"Themes\",\n                triggers: [{ element: openCustomizerButton }],\n                content: Form.placeholder(),\n                structure: form,\n                position: { my: \"right top\", at: \"right top\" }\n            });\n            $(window).on(\"storage\", (event) => {\n                let data = event.originalEvent[\"newValue\"];\n                switch (event.originalEvent[\"key\"]) {\n                    case \"theme\": {\n                        data = data || \"hexagon\";\n                        $(\"body\").attr(\"data-th-main\", data);\n                        this.$main.val(data);\n                        break;\n                    }\n                    case \"theme-extra\": {\n                        data = data || \"hexagon\";\n                        $(\"body\").attr(\"data-th-extra\", data);\n                        this.$extra.val(data);\n                        break;\n                    }\n                    case \"theme-nav\": {\n                        data = data || \"top\";\n                        $(\"body\").attr(\"data-th-nav\", data);\n                        this.$nav.val(data);\n                        break;\n                    }\n                }\n            });\n        });\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Util } from \"../../components/utility/Util\";\nimport Component from \"../Component\";\nexport class DMailHeaderButton extends Component {\n    constructor() {\n        super({\n            waitForDOM: \"menu.extra\",\n        });\n    }\n    create() {\n        return __awaiter(this, void 0, void 0, function* () {\n            Util.DOM.addSettingsButton({\n                id: \"header-button-dmail\",\n                name: `<i class=\"fas fa-envelope\"></i>`,\n                href: \"/dmails\",\n                title: \"DMail\",\n            });\n        });\n    }\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport css from \"./css/style.module.scss\";\nimport { User } from \"./js/components/data/User\";\nimport DOMTools from \"./js/components/structure/DOMTools\";\nimport { PageObserver } from \"./js/components/structure/PageObserver\";\nimport { Debug } from \"./js/components/utility/Debug\";\nimport { ErrorHandler } from \"./js/components/utility/ErrorHandler\";\nimport { HeaderCustomizer } from \"./js/modules/general/HeaderCustomizer\";\nimport { ThemeCustomizer } from \"./js/modules/general/ThemeCustomizer\";\nimport { DMailHeaderButton } from \"./js/modules/minor/DMailHeaderButton\";\nexport class RE621 {\n    constructor() {\n        this.loadOrder = [\n            // Header\n            ThemeCustomizer,\n            HeaderCustomizer,\n            DMailHeaderButton,\n        ];\n    }\n    run() {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log(\"[%cRE621 v.1.0.0%c]\", \"color: maroon\", \"color: black\");\n            // Initialize basic functionality\n            try {\n                console.log(\"+ Page Observer\");\n                PageObserver.init();\n                // Append the CSS to head, and make sure it overrides other styles\n                PageObserver.watch(\"head\").then(() => {\n                    Debug.log(\"+ HEAD is ready\");\n                    const styleElement = DOMTools.addStyle(css);\n                    $(() => { styleElement.appendTo(\"head\"); });\n                });\n                PageObserver.watch(\"body\").then(() => {\n                    Debug.log(\"+ BODY is ready\");\n                    // Dialog.init();\n                    DOMTools.setupDialogContainer(); // TODO Move to the dialog class\n                    User.init();\n                });\n                PageObserver.watch(\"menu.main\").then(() => {\n                    Debug.log(\"+ MENU is ready\");\n                    DOMTools.patchHeader();\n                });\n            }\n            catch (error) {\n                ErrorHandler.log(\"An error ocurred during script initialization\", error);\n                return;\n            }\n            // Start loading components\n            for (const module of this.loadOrder)\n                RE621.modules[module.constructor.name] = new module();\n        });\n    }\n}\n// Fill in type suggestions\nRE621.modules = {};\nnew RE621().run();\n"],"names":["Script","version","GM_info","script","handler","name","scriptHandler","url","website","repo","issues","thread","latest","UtilID","static","length","unique","getRandomString","uniqueID","uniqueIDs","has","add","result","chars","charLength","i","charAt","Math","floor","random","id","delete","Util","Time","now","slice","Set","UtilSize","UtilTime","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","done","then","apply","format","bytes","decimals","parseInt","dm","log","parseFloat","pow","toFixed","unformat","input","isNumeric","toUpperCase","index","size","entries","test","RISSizeLimit","constructor","width","height","this","post","file","img","toString","Google","Megabyte","SauceNAO","Derpibooru","Kheina","Yandex","Date","getTime","ago","time","timeFormats","seconds","token","listChoice","abs","date","parts","year","getFullYear","month","getMonth","day","getDate","hours","getHours","minutes","getMinutes","getSeconds","formatPeriod","MINUTE","SECOND","HOUR","DAY","WEEK","MONTH","YEAR","getDatetimeShort","twoDigit","n","substring","formatPlaytime","remainder","ceil","data","tempLink","$","attr","encodeURIComponent","JSON","stringify","appendTo","on","remove","click","setTimeout","method","Array","isArray","from","push","splice","indexes","undefined","replace","removeSections","num","sign","d","gcd","u","v","val","trim","toLowerCase","element","getTags","getTagString","split","filter","el","object","key","Object","keys","RegExp","join","v1","v2","options","lexicographical","zeroExtend","NaN","v1parts","v2parts","isValidPart","x","every","map","Number","array","delimiter","DOM","UtilDOM","config","target","href","title","tabClass","linkClass","$tab","$link","html","onClick","addClass","css","ID","make","Events","UtilEvents","callback","document","event","off","trigger","label","createEvent","initEvent","dispatchEvent","UtilMath","min","max","isNaN","decimal","Network","UtilNetwork","navigator","onLine","XM","Connect","xmlHttpRequest","window","location","host","onerror","onload","Size","LS","localStorage","SS","sessionStorage","XMChrome","component","module","args","chrome","runtime","sendMessage","formatRequestData","response","requests","eventID","connect","request","detail","removeEventListener","addEventListener","CustomEvent","includes","makeRequestID","extension","getURL","saveAs","downloads","download","filename","XMConnect","details","Debug","connectLog","validDetails","validateXHRDetails","GM","GM_xmlhttpRequest","Chrome","execBackgroundConnection","port","postMessage","onMessage","addListener","responseType","fetch","r","blob","arrayBuffer","URL","revokeObjectURL","callbacks","onabort","onloadstart","onprogress","onreadystatechange","ontimeout","headers","GM_getResourceText","getResourceTextGM","xmlHttpPromise","startsWith","getResourceURL","responseText","error","status","statusText","resource","getResourceUrl","GM_getResourceURL","atob","credentials","mode","ok","text","getResourceText","resolved","parse","a","b","timer","clearTimeout","btn","createObjectURL","c","getState","GM_download","scriptMetaStr","info","type","Storage","XMStorage","GM_setValue","defaultValue","GM_getValue","GM_deleteValue","GM_addValueChangeListener","GM_removeValueChangeListener","XMUtil","path","active","execBackgroundRequest","openInTab","setClipboard","Window","unsafeWindow","enabled","getValue","perform","vivaldi","setValue","deleteValue","console","obj","table","timeEnd","ENDPOINT_DEFS","node","APIEndpoint","queue","endpoint","param","get","query","delay","createRequest","getParsedPath","formatParam","formatData","first","noEncode","put","patch","output","elem","cleanURIComponent","subKey","subValue","subElement","decodeURIComponent","E621","emitter","processing","requestIndex","endpoints","authToken","forEach","definition","instance","requestBody","requestRateLimit","requestInfo","body","FormattedAPIQuery","entry","Request","origin","final","one","newItem","item","shift","sleep","Posts","getEndpoint","Post","PostVotes","Tags","Tag","TagAliases","TagImplications","Notes","Favorites","Favorite","Pools","Pool","Sets","SetAddPost","SetRemovePost","Users","User","Blips","Wiki","Comments","Comment","ForumPosts","ForumPost","ForumTopics","ForumTopic","DTextPreview","IQDBQueries","ImageScalingMode","loggedIn","userIsAnonymous","username","userName","userID","userId","level","userLevel","levelString","userLevelString","isMember","userIsMemeber","isPrivileged","userIsPrivileged","isContributor","userIsContributor","isJanitor","userIsJanitor","isModerator","userIsModerator","isAdmin","userIsAdmin","isFormerStaff","userIsFormerStaff","isVoter","userIsVoter","isVerified","userIsVerified","isApprover","userIsApprover","isBlocked","userIsBlocked","isBanned","userIsBanned","canApprovePosts","userCanApprovePosts","canUploadFree","userCanUploadFree","postsPerPage","userPerPage","commentThreshold","blacklistedTags","blacklistUsers","enableJSNavigation","enableAutoComplete","styleUsernames","defaultImageSize","user","Sample","FitHeight","FitWidth","Original","Page","pathname","getInstance","constraint","searchParams","set","refreshCurrentUrl","searchPrefix","history","replaceState","hash","hostname","regex","PageDefinition","matches","search","upload","forum","forumPost","pool","popular","favorites","wiki","wikiNA","artist","comments","settings","changes","tickets","profile","iqdb","deleted_posts","blips","help","postConfirmDelete","DOMTools","$menuContainer","$menuMain","find","last","getSiteName","prependTo","insertAfter","PageObserver","observer","targets","Map","MutationObserver","selector","querySelector","observe","childList","subtree","disconnect","pageLoaded","values","hasFocus","visibilityState","Modal","triggers","isDisabled","validateConfig","triggersMulti","triggerMulti","disabled","$modal","append","content","dialog","autoOpen","resizable","minWidth","minHeight","position","my","at","of","within","classes","closest","draggable","structure","render","registerTrigger","enable","disable","isOpen","open","close","toggle","addContent","$content","setContent","activeTrigger","preventDefault","$target","currentTarget","is","clearTriggers","getElement","destroy","getActiveTrigger","isReady","ErrorHandler","message","notice","textarea","userAgent","stack","watch","validKeys","replacedKeys","replacedRegExp","getKeyRegex","KeybindManager","blocked","keybind","register","refreshListener","executors","bindMeta","executor","listening","matched","indexOf","sequence","listeners","keydown","listenerExecutor","keyObj","holdable","fnct","$element","cooldown","Form","onSubmit","columns","wrapper","inputList","force","created","innerHTML","formID","childElem","build","getInputs","reset","defval","prop","getInputList","names","results","spacer","$label","FormUtils","makeLabel","toggleClass","FormElement","postElement","accordion","animate","collapsible","header","subheader","badge","onActivate","container","collapsed","beforeActivate","changed","makeInputWrapper","$input","pattern","required","inputTimeout","$copyButton","copyTimer","removeClass","$warning","count","$recordButton","occupied","duplicates","parent","record","newVal","accept","$selectContainer","div","unmargin","postProcessing","getInput","parentID","$subLabel","Component","initialized","eventIndex","Settings","constraintMatches","waitForDOM","DOMLoadConditions","SettingsCache","execPrepare","bootstrapSettings","execCreate","savedValue","passedThis","defineProperty","newValue","settingsTag","oldValue","remote","load","unload","execDestroy","reload","prepare","create","HeaderCustomizer","super","editingMode","hotkeyTab1","hotkeyTab2","hotkeyTab3","hotkeyTab4","hotkeyTab5","hotkeyTab6","hotkeyTab7","hotkeyTab8","hotkeyTab9","tabs","forumUpdateDot","isEditing","$menu","sortable","addTabModal","updateTabModal","hasForumUpdates","hasClass","$oldMenu","children","rebuildTabs","toggleForumDot","createConfigInterface","axis","containment","helper","forceHelperSize","opacity","cursor","update","reloadTabMargins","saveNavbarSettings","empty","addTabButton","addSettingsButton","newTabForm","checkbox","button","hr","copy","form","addTab","right","placeholder","updateTabForm","deleteTab","updateTab","$updateTabInputs","createTabElement","state","triggerUpdate","parseHeaderTabConfig","processTabVariables","tab","link","newTab","removeAttr","tabData","formatVal","each","ThemeCustomizer","openCustomizerButton","select","$main","getItem","setItem","$extra","$nav","originalEvent","DMailHeaderButton","RE621","loadOrder","run","init","styleElement","addStyle","setupDialogContainer","patchHeader","modules"],"sourceRoot":""}